{
  "$ref": "#/definitions/Authentication",
  "definitions": {
    "Authentication": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "api_key",
              "description": "Authentication type"
            },
            "apiKey": {
              "type": "string",
              "description": "API key (typically from ENV)"
            },
            "headerName": {
              "type": "string",
              "default": "X-API-Key",
              "description": "HTTP header name for API key"
            },
            "paramName": {
              "type": "string",
              "description": "Query parameter name (alternative to header)"
            }
          },
          "required": [
            "type",
            "apiKey"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "oauth2",
              "description": "Authentication type"
            },
            "clientId": {
              "type": "string",
              "description": "OAuth2 client ID"
            },
            "clientSecret": {
              "type": "string",
              "description": "OAuth2 client secret (typically from ENV)"
            },
            "authorizationUrl": {
              "type": "string",
              "format": "uri",
              "description": "OAuth2 authorization endpoint"
            },
            "tokenUrl": {
              "type": "string",
              "format": "uri",
              "description": "OAuth2 token endpoint"
            },
            "scopes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Requested OAuth2 scopes"
            },
            "redirectUri": {
              "type": "string",
              "format": "uri",
              "description": "OAuth2 callback URL"
            },
            "grantType": {
              "type": "string",
              "enum": [
                "authorization_code",
                "client_credentials",
                "password",
                "refresh_token"
              ],
              "default": "authorization_code",
              "description": "OAuth2 grant type"
            },
            "refreshToken": {
              "type": "string",
              "description": "Refresh token for token renewal"
            },
            "tokenExpiry": {
              "type": "number",
              "description": "Token expiry timestamp"
            }
          },
          "required": [
            "type",
            "clientId",
            "clientSecret",
            "authorizationUrl",
            "tokenUrl"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "jwt",
              "description": "Authentication type"
            },
            "token": {
              "type": "string",
              "description": "Pre-generated JWT token"
            },
            "secretKey": {
              "type": "string",
              "description": "Secret key for JWT signing"
            },
            "algorithm": {
              "type": "string",
              "enum": [
                "HS256",
                "HS384",
                "HS512",
                "RS256",
                "RS384",
                "RS512",
                "ES256",
                "ES384",
                "ES512"
              ],
              "default": "HS256",
              "description": "JWT signing algorithm"
            },
            "issuer": {
              "type": "string",
              "description": "JWT issuer claim"
            },
            "audience": {
              "type": "string",
              "description": "JWT audience claim"
            },
            "subject": {
              "type": "string",
              "description": "JWT subject claim"
            },
            "expiresIn": {
              "type": "number",
              "default": 3600,
              "description": "Token expiry in seconds"
            },
            "claims": {
              "type": "object",
              "additionalProperties": {},
              "description": "Additional JWT claims"
            }
          },
          "required": [
            "type"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "saml",
              "description": "Authentication type"
            },
            "entryPoint": {
              "type": "string",
              "format": "uri",
              "description": "SAML IdP entry point URL"
            },
            "issuer": {
              "type": "string",
              "description": "SAML service provider issuer"
            },
            "certificate": {
              "type": "string",
              "description": "SAML IdP certificate (X.509)"
            },
            "privateKey": {
              "type": "string",
              "description": "SAML service provider private key"
            },
            "callbackUrl": {
              "type": "string",
              "format": "uri",
              "description": "SAML assertion consumer service URL"
            },
            "signatureAlgorithm": {
              "type": "string",
              "enum": [
                "sha1",
                "sha256",
                "sha512"
              ],
              "default": "sha256",
              "description": "SAML signature algorithm"
            },
            "wantAssertionsSigned": {
              "type": "boolean",
              "default": true,
              "description": "Require signed SAML assertions"
            },
            "identifierFormat": {
              "type": "string",
              "description": "SAML NameID format"
            }
          },
          "required": [
            "type",
            "entryPoint",
            "issuer",
            "certificate"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "basic",
              "description": "Authentication type"
            },
            "username": {
              "type": "string",
              "description": "Username"
            },
            "password": {
              "type": "string",
              "description": "Password (typically from ENV)"
            }
          },
          "required": [
            "type",
            "username",
            "password"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "bearer",
              "description": "Authentication type"
            },
            "token": {
              "type": "string",
              "description": "Bearer token"
            }
          },
          "required": [
            "type",
            "token"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "none",
              "description": "No authentication required"
            }
          },
          "required": [
            "type"
          ],
          "additionalProperties": false
        }
      ]
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}