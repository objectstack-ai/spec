{
  "$ref": "#/definitions/RestApiPluginConfig",
  "definitions": {
    "RestApiPluginConfig": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true,
          "description": "Enable REST API plugin"
        },
        "basePath": {
          "type": "string",
          "default": "/api",
          "description": "Base path for all API routes"
        },
        "version": {
          "type": "string",
          "default": "v1",
          "description": "API version identifier"
        },
        "routes": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "prefix": {
                "type": "string",
                "pattern": "^\\/",
                "description": "URL path prefix for this route group"
              },
              "service": {
                "type": "string",
                "description": "Core service name (metadata, data, auth, etc.)"
              },
              "category": {
                "type": "string",
                "enum": [
                  "discovery",
                  "metadata",
                  "data",
                  "batch",
                  "permission",
                  "analytics",
                  "automation",
                  "workflow",
                  "ui",
                  "realtime",
                  "notification",
                  "ai",
                  "i18n"
                ],
                "description": "Primary category for this route group"
              },
              "methods": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "Protocol method names implemented"
              },
              "endpoints": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "method": {
                      "type": "string",
                      "enum": [
                        "GET",
                        "POST",
                        "PUT",
                        "DELETE",
                        "PATCH",
                        "HEAD",
                        "OPTIONS"
                      ],
                      "description": "HTTP method for this endpoint"
                    },
                    "path": {
                      "type": "string",
                      "description": "URL path pattern (e.g., /api/v1/data/:object/:id)"
                    },
                    "handler": {
                      "type": "string",
                      "description": "Protocol method name or handler identifier"
                    },
                    "category": {
                      "type": "string",
                      "enum": [
                        "discovery",
                        "metadata",
                        "data",
                        "batch",
                        "permission",
                        "analytics",
                        "automation",
                        "workflow",
                        "ui",
                        "realtime",
                        "notification",
                        "ai",
                        "i18n"
                      ],
                      "description": "Route category"
                    },
                    "public": {
                      "type": "boolean",
                      "default": false,
                      "description": "Is publicly accessible without authentication"
                    },
                    "permissions": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "description": "Required permissions (e.g., [\"data.read\", \"object.account.read\"])"
                    },
                    "summary": {
                      "type": "string",
                      "description": "Short description for OpenAPI"
                    },
                    "description": {
                      "type": "string",
                      "description": "Detailed description for OpenAPI"
                    },
                    "tags": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "description": "OpenAPI tags for grouping"
                    },
                    "requestSchema": {
                      "type": "string",
                      "description": "Request schema name (for validation)"
                    },
                    "responseSchema": {
                      "type": "string",
                      "description": "Response schema name (for documentation)"
                    },
                    "timeout": {
                      "type": "integer",
                      "description": "Request timeout in milliseconds"
                    },
                    "rateLimit": {
                      "type": "string",
                      "description": "Rate limit policy name"
                    },
                    "cacheable": {
                      "type": "boolean",
                      "default": false,
                      "description": "Whether response can be cached"
                    },
                    "cacheTtl": {
                      "type": "integer",
                      "description": "Cache TTL in seconds"
                    }
                  },
                  "required": [
                    "method",
                    "path",
                    "handler",
                    "category"
                  ],
                  "additionalProperties": false
                },
                "description": "Endpoint definitions"
              },
              "middleware": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string",
                      "pattern": "^[a-z_][a-z0-9_]*$",
                      "description": "Middleware name (snake_case)"
                    },
                    "type": {
                      "type": "string",
                      "enum": [
                        "authentication",
                        "authorization",
                        "logging",
                        "validation",
                        "transformation",
                        "error",
                        "custom"
                      ],
                      "description": "Middleware type"
                    },
                    "enabled": {
                      "type": "boolean",
                      "default": true,
                      "description": "Whether middleware is enabled"
                    },
                    "order": {
                      "type": "integer",
                      "default": 100,
                      "description": "Execution order priority"
                    },
                    "config": {
                      "type": "object",
                      "additionalProperties": {},
                      "description": "Middleware configuration object"
                    },
                    "paths": {
                      "type": "object",
                      "properties": {
                        "include": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "description": "Include path patterns (glob)"
                        },
                        "exclude": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "description": "Exclude path patterns (glob)"
                        }
                      },
                      "additionalProperties": false,
                      "description": "Path filtering"
                    }
                  },
                  "required": [
                    "name",
                    "type"
                  ],
                  "additionalProperties": false
                },
                "description": "Middleware stack for this route group"
              },
              "authRequired": {
                "type": "boolean",
                "default": true,
                "description": "Whether authentication is required by default"
              },
              "documentation": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string",
                    "description": "Route group title"
                  },
                  "description": {
                    "type": "string",
                    "description": "Route group description"
                  },
                  "tags": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "OpenAPI tags"
                  }
                },
                "additionalProperties": false,
                "description": "Documentation metadata for this route group"
              }
            },
            "required": [
              "prefix",
              "service",
              "category"
            ],
            "additionalProperties": false
          },
          "description": "Route registrations"
        },
        "validation": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true,
              "description": "Enable automatic request validation"
            },
            "mode": {
              "type": "string",
              "enum": [
                "strict",
                "permissive",
                "strip"
              ],
              "default": "strict",
              "description": "How to handle validation errors"
            },
            "validateBody": {
              "type": "boolean",
              "default": true,
              "description": "Validate request body against schema"
            },
            "validateQuery": {
              "type": "boolean",
              "default": true,
              "description": "Validate query string parameters"
            },
            "validateParams": {
              "type": "boolean",
              "default": true,
              "description": "Validate URL path parameters"
            },
            "validateHeaders": {
              "type": "boolean",
              "default": false,
              "description": "Validate request headers"
            },
            "includeFieldErrors": {
              "type": "boolean",
              "default": true,
              "description": "Include field-level error details in response"
            },
            "errorPrefix": {
              "type": "string",
              "description": "Custom prefix for validation error messages"
            },
            "schemaRegistry": {
              "type": "string",
              "description": "Schema registry name to use for validation"
            }
          },
          "additionalProperties": false,
          "description": "Request validation configuration"
        },
        "responseEnvelope": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true,
              "description": "Enable automatic response envelope wrapping"
            },
            "includeMetadata": {
              "type": "boolean",
              "default": true,
              "description": "Include meta object in responses"
            },
            "includeTimestamp": {
              "type": "boolean",
              "default": true,
              "description": "Include timestamp in response metadata"
            },
            "includeRequestId": {
              "type": "boolean",
              "default": true,
              "description": "Include requestId in response metadata"
            },
            "includeDuration": {
              "type": "boolean",
              "default": false,
              "description": "Include request duration in ms"
            },
            "includeTraceId": {
              "type": "boolean",
              "default": false,
              "description": "Include distributed traceId"
            },
            "customMetadata": {
              "type": "object",
              "additionalProperties": {},
              "description": "Additional metadata fields to include"
            },
            "skipIfWrapped": {
              "type": "boolean",
              "default": true,
              "description": "Skip wrapping if response already has success field"
            }
          },
          "additionalProperties": false,
          "description": "Response envelope configuration"
        },
        "errorHandling": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true,
              "description": "Enable standardized error handling"
            },
            "includeStackTrace": {
              "type": "boolean",
              "default": false,
              "description": "Include stack traces in error responses"
            },
            "logErrors": {
              "type": "boolean",
              "default": true,
              "description": "Log errors to system logger"
            },
            "exposeInternalErrors": {
              "type": "boolean",
              "default": false,
              "description": "Expose internal error details in responses"
            },
            "includeRequestId": {
              "type": "boolean",
              "default": true,
              "description": "Include requestId in error responses"
            },
            "includeTimestamp": {
              "type": "boolean",
              "default": true,
              "description": "Include timestamp in error responses"
            },
            "includeDocumentation": {
              "type": "boolean",
              "default": true,
              "description": "Include documentation URLs for errors"
            },
            "documentationBaseUrl": {
              "type": "string",
              "format": "uri",
              "description": "Base URL for error documentation"
            },
            "customErrorMessages": {
              "type": "object",
              "additionalProperties": {
                "type": "string"
              },
              "description": "Custom error messages by error code"
            },
            "redactFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Field names to redact from error details"
            }
          },
          "additionalProperties": false,
          "description": "Error handling configuration"
        },
        "openApi": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true,
              "description": "Enable automatic OpenAPI documentation generation"
            },
            "version": {
              "type": "string",
              "enum": [
                "3.0.0",
                "3.0.1",
                "3.0.2",
                "3.0.3",
                "3.1.0"
              ],
              "default": "3.0.3",
              "description": "OpenAPI specification version"
            },
            "title": {
              "type": "string",
              "default": "ObjectStack API",
              "description": "API title"
            },
            "description": {
              "type": "string",
              "description": "API description"
            },
            "apiVersion": {
              "type": "string",
              "default": "1.0.0",
              "description": "API version"
            },
            "outputPath": {
              "type": "string",
              "default": "/api/docs/openapi.json",
              "description": "URL path to serve OpenAPI JSON"
            },
            "uiPath": {
              "type": "string",
              "default": "/api/docs",
              "description": "URL path to serve documentation UI"
            },
            "uiFramework": {
              "type": "string",
              "enum": [
                "swagger-ui",
                "redoc",
                "rapidoc",
                "elements"
              ],
              "default": "swagger-ui",
              "description": "Documentation UI framework"
            },
            "includeInternal": {
              "type": "boolean",
              "default": false,
              "description": "Include internal endpoints in documentation"
            },
            "generateSchemas": {
              "type": "boolean",
              "default": true,
              "description": "Auto-generate schemas from Zod definitions"
            },
            "includeExamples": {
              "type": "boolean",
              "default": true,
              "description": "Include request/response examples"
            },
            "servers": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "url": {
                    "type": "string",
                    "description": "Server URL"
                  },
                  "description": {
                    "type": "string",
                    "description": "Server description"
                  }
                },
                "required": [
                  "url"
                ],
                "additionalProperties": false
              },
              "description": "Server URLs for API"
            },
            "contact": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string"
                },
                "url": {
                  "type": "string",
                  "format": "uri"
                },
                "email": {
                  "type": "string",
                  "format": "email"
                }
              },
              "additionalProperties": false,
              "description": "API contact information"
            },
            "license": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "License name"
                },
                "url": {
                  "type": "string",
                  "format": "uri",
                  "description": "License URL"
                }
              },
              "required": [
                "name"
              ],
              "additionalProperties": false,
              "description": "API license information"
            },
            "securitySchemes": {
              "type": "object",
              "additionalProperties": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "apiKey",
                      "http",
                      "oauth2",
                      "openIdConnect"
                    ]
                  },
                  "scheme": {
                    "type": "string"
                  },
                  "bearerFormat": {
                    "type": "string"
                  }
                },
                "required": [
                  "type"
                ],
                "additionalProperties": false
              },
              "description": "Security scheme definitions"
            }
          },
          "additionalProperties": false,
          "description": "OpenAPI documentation configuration"
        },
        "globalMiddleware": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "pattern": "^[a-z_][a-z0-9_]*$",
                "description": "Middleware name (snake_case)"
              },
              "type": {
                "type": "string",
                "enum": [
                  "authentication",
                  "authorization",
                  "logging",
                  "validation",
                  "transformation",
                  "error",
                  "custom"
                ],
                "description": "Middleware type"
              },
              "enabled": {
                "type": "boolean",
                "default": true,
                "description": "Whether middleware is enabled"
              },
              "order": {
                "type": "integer",
                "default": 100,
                "description": "Execution order priority"
              },
              "config": {
                "type": "object",
                "additionalProperties": {},
                "description": "Middleware configuration object"
              },
              "paths": {
                "type": "object",
                "properties": {
                  "include": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Include path patterns (glob)"
                  },
                  "exclude": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Exclude path patterns (glob)"
                  }
                },
                "additionalProperties": false,
                "description": "Path filtering"
              }
            },
            "required": [
              "name",
              "type"
            ],
            "additionalProperties": false
          },
          "description": "Global middleware stack"
        },
        "cors": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true
            },
            "origins": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "methods": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "GET",
                  "POST",
                  "PUT",
                  "DELETE",
                  "PATCH",
                  "HEAD",
                  "OPTIONS"
                ]
              }
            },
            "credentials": {
              "type": "boolean",
              "default": true
            }
          },
          "additionalProperties": false,
          "description": "CORS configuration"
        },
        "performance": {
          "type": "object",
          "properties": {
            "enableCompression": {
              "type": "boolean",
              "default": true,
              "description": "Enable response compression"
            },
            "enableETag": {
              "type": "boolean",
              "default": true,
              "description": "Enable ETag generation"
            },
            "enableCaching": {
              "type": "boolean",
              "default": true,
              "description": "Enable HTTP caching"
            },
            "defaultCacheTtl": {
              "type": "integer",
              "default": 300,
              "description": "Default cache TTL in seconds"
            }
          },
          "additionalProperties": false,
          "description": "Performance optimization settings"
        }
      },
      "required": [
        "routes"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}