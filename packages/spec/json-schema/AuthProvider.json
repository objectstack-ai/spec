{
  "$ref": "#/definitions/AuthProvider",
  "definitions": {
    "AuthProvider": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "pattern": "^[a-z_][a-z0-9_]*$",
          "description": "Provider ID"
        },
        "label": {
          "type": "string",
          "description": "Button Label (e.g. \"Login with Okta\")"
        },
        "type": {
          "type": "string",
          "enum": [
            "oidc",
            "saml",
            "ldap",
            "oauth2",
            "local",
            "mock"
          ]
        },
        "config": {
          "anyOf": [
            {
              "type": "object",
              "properties": {
                "issuer": {
                  "type": "string",
                  "format": "uri",
                  "description": "OIDC Issuer URL (.well-known/openid-configuration)"
                },
                "clientId": {
                  "type": "string"
                },
                "clientSecret": {
                  "type": "string"
                },
                "scopes": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "default": [
                    "openid",
                    "profile",
                    "email"
                  ]
                },
                "attributeMapping": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  },
                  "description": "Map IdP claims to User fields"
                }
              },
              "required": [
                "issuer",
                "clientId",
                "clientSecret"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "entryPoint": {
                  "type": "string",
                  "format": "uri",
                  "description": "IdP SSO URL"
                },
                "cert": {
                  "type": "string",
                  "description": "IdP Public Certificate"
                },
                "issuer": {
                  "type": "string",
                  "description": "Entity ID of the IdP"
                },
                "signatureAlgorithm": {
                  "type": "string",
                  "enum": [
                    "sha256",
                    "sha512"
                  ],
                  "default": "sha256"
                },
                "attributeMapping": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              },
              "required": [
                "entryPoint",
                "cert",
                "issuer"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "url": {
                  "type": "string",
                  "format": "uri",
                  "description": "LDAP Server URL (ldap:// or ldaps://)"
                },
                "bindDn": {
                  "type": "string"
                },
                "bindCredentials": {
                  "type": "string"
                },
                "searchBase": {
                  "type": "string"
                },
                "searchFilter": {
                  "type": "string"
                },
                "groupSearchBase": {
                  "type": "string"
                }
              },
              "required": [
                "url",
                "bindDn",
                "bindCredentials",
                "searchBase",
                "searchFilter"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "additionalProperties": {}
            }
          ],
          "description": "Provider specific configuration"
        },
        "icon": {
          "type": "string",
          "description": "Icon URL or helper class"
        },
        "active": {
          "type": "boolean",
          "default": true
        },
        "registrationEnabled": {
          "type": "boolean",
          "default": false,
          "description": "Allow new users to sign up via this provider"
        }
      },
      "required": [
        "name",
        "label",
        "type",
        "config"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}