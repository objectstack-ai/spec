{
  "$ref": "#/definitions/OAuth2Auth",
  "definitions": {
    "OAuth2Auth": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "oauth2",
          "description": "Authentication type"
        },
        "clientId": {
          "type": "string",
          "description": "OAuth2 client ID"
        },
        "clientSecret": {
          "type": "string",
          "description": "OAuth2 client secret (typically from ENV)"
        },
        "authorizationUrl": {
          "type": "string",
          "format": "uri",
          "description": "OAuth2 authorization endpoint"
        },
        "tokenUrl": {
          "type": "string",
          "format": "uri",
          "description": "OAuth2 token endpoint"
        },
        "scopes": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Requested OAuth2 scopes"
        },
        "redirectUri": {
          "type": "string",
          "format": "uri",
          "description": "OAuth2 callback URL"
        },
        "grantType": {
          "type": "string",
          "enum": [
            "authorization_code",
            "client_credentials",
            "password",
            "refresh_token"
          ],
          "default": "authorization_code",
          "description": "OAuth2 grant type"
        },
        "refreshToken": {
          "type": "string",
          "description": "Refresh token for token renewal"
        },
        "tokenExpiry": {
          "type": "number",
          "description": "Token expiry timestamp"
        }
      },
      "required": [
        "type",
        "clientId",
        "clientSecret",
        "authorizationUrl",
        "tokenUrl"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}