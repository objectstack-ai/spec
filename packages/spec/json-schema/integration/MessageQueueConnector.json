{
  "$ref": "#/definitions/MessageQueueConnector",
  "definitions": {
    "MessageQueueConnector": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "pattern": "^[a-z_][a-z0-9_]*$",
          "description": "Unique connector identifier"
        },
        "label": {
          "type": "string",
          "description": "Display label"
        },
        "type": {
          "type": "string",
          "const": "message_queue"
        },
        "description": {
          "type": "string",
          "description": "Connector description"
        },
        "icon": {
          "type": "string",
          "description": "Icon identifier"
        },
        "authentication": {
          "anyOf": [
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "api_key",
                  "description": "Authentication type"
                },
                "apiKey": {
                  "type": "string",
                  "description": "API key (typically from ENV)"
                },
                "headerName": {
                  "type": "string",
                  "default": "X-API-Key",
                  "description": "HTTP header name for API key"
                },
                "paramName": {
                  "type": "string",
                  "description": "Query parameter name (alternative to header)"
                }
              },
              "required": [
                "type",
                "apiKey"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "oauth2",
                  "description": "Authentication type"
                },
                "clientId": {
                  "type": "string",
                  "description": "OAuth2 client ID"
                },
                "clientSecret": {
                  "type": "string",
                  "description": "OAuth2 client secret (typically from ENV)"
                },
                "authorizationUrl": {
                  "type": "string",
                  "format": "uri",
                  "description": "OAuth2 authorization endpoint"
                },
                "tokenUrl": {
                  "type": "string",
                  "format": "uri",
                  "description": "OAuth2 token endpoint"
                },
                "scopes": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "Requested OAuth2 scopes"
                },
                "redirectUri": {
                  "type": "string",
                  "format": "uri",
                  "description": "OAuth2 callback URL"
                },
                "grantType": {
                  "type": "string",
                  "enum": [
                    "authorization_code",
                    "client_credentials",
                    "password",
                    "refresh_token"
                  ],
                  "default": "authorization_code",
                  "description": "OAuth2 grant type"
                },
                "refreshToken": {
                  "type": "string",
                  "description": "Refresh token for token renewal"
                },
                "tokenExpiry": {
                  "type": "number",
                  "description": "Token expiry timestamp"
                }
              },
              "required": [
                "type",
                "clientId",
                "clientSecret",
                "authorizationUrl",
                "tokenUrl"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "jwt",
                  "description": "Authentication type"
                },
                "token": {
                  "type": "string",
                  "description": "Pre-generated JWT token"
                },
                "secretKey": {
                  "type": "string",
                  "description": "Secret key for JWT signing"
                },
                "algorithm": {
                  "type": "string",
                  "enum": [
                    "HS256",
                    "HS384",
                    "HS512",
                    "RS256",
                    "RS384",
                    "RS512",
                    "ES256",
                    "ES384",
                    "ES512"
                  ],
                  "default": "HS256",
                  "description": "JWT signing algorithm"
                },
                "issuer": {
                  "type": "string",
                  "description": "JWT issuer claim"
                },
                "audience": {
                  "type": "string",
                  "description": "JWT audience claim"
                },
                "subject": {
                  "type": "string",
                  "description": "JWT subject claim"
                },
                "expiresIn": {
                  "type": "number",
                  "default": 3600,
                  "description": "Token expiry in seconds"
                },
                "claims": {
                  "type": "object",
                  "additionalProperties": {},
                  "description": "Additional JWT claims"
                }
              },
              "required": [
                "type"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "saml",
                  "description": "Authentication type"
                },
                "entryPoint": {
                  "type": "string",
                  "format": "uri",
                  "description": "SAML IdP entry point URL"
                },
                "issuer": {
                  "type": "string",
                  "description": "SAML service provider issuer"
                },
                "certificate": {
                  "type": "string",
                  "description": "SAML IdP certificate (X.509)"
                },
                "privateKey": {
                  "type": "string",
                  "description": "SAML service provider private key"
                },
                "callbackUrl": {
                  "type": "string",
                  "format": "uri",
                  "description": "SAML assertion consumer service URL"
                },
                "signatureAlgorithm": {
                  "type": "string",
                  "enum": [
                    "sha1",
                    "sha256",
                    "sha512"
                  ],
                  "default": "sha256",
                  "description": "SAML signature algorithm"
                },
                "wantAssertionsSigned": {
                  "type": "boolean",
                  "default": true,
                  "description": "Require signed SAML assertions"
                },
                "identifierFormat": {
                  "type": "string",
                  "description": "SAML NameID format"
                }
              },
              "required": [
                "type",
                "entryPoint",
                "issuer",
                "certificate"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "basic",
                  "description": "Authentication type"
                },
                "username": {
                  "type": "string",
                  "description": "Username"
                },
                "password": {
                  "type": "string",
                  "description": "Password (typically from ENV)"
                }
              },
              "required": [
                "type",
                "username",
                "password"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "bearer",
                  "description": "Authentication type"
                },
                "token": {
                  "type": "string",
                  "description": "Bearer token"
                }
              },
              "required": [
                "type",
                "token"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "none",
                  "description": "No authentication required"
                }
              },
              "required": [
                "type"
              ],
              "additionalProperties": false
            }
          ],
          "description": "Authentication configuration"
        },
        "syncConfig": {
          "type": "object",
          "properties": {
            "strategy": {
              "type": "string",
              "enum": [
                "full",
                "incremental",
                "upsert",
                "append_only"
              ],
              "description": "Synchronization strategy",
              "default": "incremental"
            },
            "direction": {
              "type": "string",
              "enum": [
                "import",
                "export",
                "bidirectional"
              ],
              "default": "import",
              "description": "Sync direction"
            },
            "schedule": {
              "type": "string",
              "description": "Cron expression for scheduled sync"
            },
            "realtimeSync": {
              "type": "boolean",
              "default": false,
              "description": "Enable real-time sync"
            },
            "timestampField": {
              "type": "string",
              "description": "Field to track last modification time"
            },
            "conflictResolution": {
              "type": "string",
              "enum": [
                "source_wins",
                "target_wins",
                "latest_wins",
                "manual"
              ],
              "description": "Conflict resolution strategy",
              "default": "latest_wins"
            },
            "batchSize": {
              "type": "number",
              "minimum": 1,
              "maximum": 10000,
              "default": 1000,
              "description": "Records per batch"
            },
            "deleteMode": {
              "type": "string",
              "enum": [
                "hard_delete",
                "soft_delete",
                "ignore"
              ],
              "default": "soft_delete",
              "description": "Delete handling mode"
            },
            "filters": {
              "type": "object",
              "additionalProperties": {},
              "description": "Filter criteria for selective sync"
            }
          },
          "additionalProperties": false,
          "description": "Data sync configuration"
        },
        "fieldMappings": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "sourceField": {
                "type": "string",
                "description": "Field name in external system"
              },
              "targetField": {
                "type": "string",
                "pattern": "^[a-z_][a-z0-9_]*$",
                "description": "Field name in ObjectStack (snake_case)"
              },
              "dataType": {
                "type": "string",
                "enum": [
                  "string",
                  "number",
                  "boolean",
                  "date",
                  "datetime",
                  "json",
                  "array"
                ],
                "description": "Target data type"
              },
              "required": {
                "type": "boolean",
                "default": false,
                "description": "Field is required"
              },
              "defaultValue": {
                "description": "Default value"
              },
              "transform": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "uppercase",
                      "lowercase",
                      "trim",
                      "date_format",
                      "number_format",
                      "custom"
                    ],
                    "description": "Transformation type"
                  },
                  "params": {
                    "type": "object",
                    "additionalProperties": {},
                    "description": "Transformation parameters"
                  },
                  "function": {
                    "type": "string",
                    "description": "Custom JavaScript function for transformation"
                  }
                },
                "required": [
                  "type"
                ],
                "additionalProperties": false,
                "description": "Field transformation"
              },
              "syncMode": {
                "type": "string",
                "enum": [
                  "read_only",
                  "write_only",
                  "bidirectional"
                ],
                "default": "bidirectional",
                "description": "Sync mode"
              }
            },
            "required": [
              "sourceField",
              "targetField"
            ],
            "additionalProperties": false
          },
          "description": "Field mapping rules"
        },
        "webhooks": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "url": {
                "type": "string",
                "format": "uri",
                "description": "Webhook endpoint URL"
              },
              "events": {
                "type": "array",
                "items": {
                  "type": "string",
                  "enum": [
                    "record.created",
                    "record.updated",
                    "record.deleted",
                    "sync.started",
                    "sync.completed",
                    "sync.failed",
                    "auth.expired",
                    "rate_limit.exceeded"
                  ],
                  "description": "Webhook event type"
                },
                "description": "Events to subscribe to"
              },
              "secret": {
                "type": "string",
                "description": "Secret for HMAC signature"
              },
              "signatureAlgorithm": {
                "type": "string",
                "enum": [
                  "hmac_sha256",
                  "hmac_sha512",
                  "none"
                ],
                "description": "Webhook signature algorithm",
                "default": "hmac_sha256"
              },
              "headers": {
                "type": "object",
                "additionalProperties": {
                  "type": "string"
                },
                "description": "Custom HTTP headers"
              },
              "retryConfig": {
                "type": "object",
                "properties": {
                  "maxAttempts": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 10,
                    "default": 3,
                    "description": "Maximum retry attempts"
                  },
                  "backoffMultiplier": {
                    "type": "number",
                    "minimum": 1,
                    "default": 2,
                    "description": "Exponential backoff multiplier"
                  },
                  "initialDelayMs": {
                    "type": "number",
                    "minimum": 100,
                    "default": 1000,
                    "description": "Initial retry delay in ms"
                  }
                },
                "additionalProperties": false,
                "description": "Retry configuration"
              },
              "timeoutMs": {
                "type": "number",
                "minimum": 1000,
                "maximum": 60000,
                "default": 30000,
                "description": "Request timeout in ms"
              },
              "enabled": {
                "type": "boolean",
                "default": true,
                "description": "Enable webhook"
              }
            },
            "required": [
              "url",
              "events"
            ],
            "additionalProperties": false
          },
          "description": "Webhook configurations"
        },
        "rateLimitConfig": {
          "type": "object",
          "properties": {
            "strategy": {
              "type": "string",
              "enum": [
                "fixed_window",
                "sliding_window",
                "token_bucket",
                "leaky_bucket"
              ],
              "description": "Rate limiting strategy",
              "default": "token_bucket"
            },
            "maxRequests": {
              "type": "number",
              "minimum": 1,
              "description": "Maximum requests per window"
            },
            "windowSeconds": {
              "type": "number",
              "minimum": 1,
              "description": "Time window in seconds"
            },
            "burstCapacity": {
              "type": "number",
              "minimum": 1,
              "description": "Burst capacity"
            },
            "respectUpstreamLimits": {
              "type": "boolean",
              "default": true,
              "description": "Respect external rate limit headers"
            },
            "rateLimitHeaders": {
              "type": "object",
              "properties": {
                "remaining": {
                  "type": "string",
                  "default": "X-RateLimit-Remaining",
                  "description": "Header for remaining requests"
                },
                "limit": {
                  "type": "string",
                  "default": "X-RateLimit-Limit",
                  "description": "Header for rate limit"
                },
                "reset": {
                  "type": "string",
                  "default": "X-RateLimit-Reset",
                  "description": "Header for reset time"
                }
              },
              "additionalProperties": false,
              "description": "Custom rate limit headers"
            }
          },
          "required": [
            "maxRequests",
            "windowSeconds"
          ],
          "additionalProperties": false,
          "description": "Rate limiting configuration"
        },
        "retryConfig": {
          "type": "object",
          "properties": {
            "strategy": {
              "type": "string",
              "enum": [
                "exponential_backoff",
                "linear_backoff",
                "fixed_delay",
                "no_retry"
              ],
              "description": "Retry strategy",
              "default": "exponential_backoff"
            },
            "maxAttempts": {
              "type": "number",
              "minimum": 0,
              "maximum": 10,
              "default": 3,
              "description": "Maximum retry attempts"
            },
            "initialDelayMs": {
              "type": "number",
              "minimum": 100,
              "default": 1000,
              "description": "Initial retry delay in ms"
            },
            "maxDelayMs": {
              "type": "number",
              "minimum": 1000,
              "default": 60000,
              "description": "Maximum retry delay in ms"
            },
            "backoffMultiplier": {
              "type": "number",
              "minimum": 1,
              "default": 2,
              "description": "Exponential backoff multiplier"
            },
            "retryableStatusCodes": {
              "type": "array",
              "items": {
                "type": "number"
              },
              "default": [
                408,
                429,
                500,
                502,
                503,
                504
              ],
              "description": "HTTP status codes to retry"
            },
            "retryOnNetworkError": {
              "type": "boolean",
              "default": true,
              "description": "Retry on network errors"
            },
            "jitter": {
              "type": "boolean",
              "default": true,
              "description": "Add jitter to retry delays"
            }
          },
          "additionalProperties": false,
          "description": "Retry configuration"
        },
        "connectionTimeoutMs": {
          "type": "number",
          "minimum": 1000,
          "maximum": 300000,
          "default": 30000,
          "description": "Connection timeout in ms"
        },
        "requestTimeoutMs": {
          "type": "number",
          "minimum": 1000,
          "maximum": 300000,
          "default": 30000,
          "description": "Request timeout in ms"
        },
        "status": {
          "type": "string",
          "enum": [
            "active",
            "inactive",
            "error",
            "configuring"
          ],
          "description": "Connector status",
          "default": "inactive"
        },
        "enabled": {
          "type": "boolean",
          "default": true,
          "description": "Enable connector"
        },
        "metadata": {
          "type": "object",
          "additionalProperties": {},
          "description": "Custom connector metadata"
        },
        "provider": {
          "type": "string",
          "enum": [
            "rabbitmq",
            "kafka",
            "redis_pubsub",
            "redis_streams",
            "aws_sqs",
            "aws_sns",
            "google_pubsub",
            "azure_service_bus",
            "azure_event_hubs",
            "nats",
            "pulsar",
            "activemq",
            "custom"
          ],
          "description": "Message queue provider type"
        },
        "brokerConfig": {
          "type": "object",
          "properties": {
            "brokers": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Broker addresses (host:port)"
            },
            "clientId": {
              "type": "string",
              "description": "Client ID"
            },
            "connectionTimeoutMs": {
              "type": "number",
              "minimum": 1000,
              "default": 30000,
              "description": "Connection timeout in ms"
            },
            "requestTimeoutMs": {
              "type": "number",
              "minimum": 1000,
              "default": 30000,
              "description": "Request timeout in ms"
            }
          },
          "required": [
            "brokers"
          ],
          "additionalProperties": false,
          "description": "Broker connection configuration"
        },
        "topics": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "pattern": "^[a-z_][a-z0-9_]*$",
                "description": "Topic/queue identifier in ObjectStack (snake_case)"
              },
              "label": {
                "type": "string",
                "description": "Display label"
              },
              "topicName": {
                "type": "string",
                "description": "Actual topic/queue name in message queue system"
              },
              "enabled": {
                "type": "boolean",
                "default": true,
                "description": "Enable sync for this topic/queue"
              },
              "mode": {
                "type": "string",
                "enum": [
                  "consumer",
                  "producer",
                  "both"
                ],
                "default": "both",
                "description": "Consumer, producer, or both"
              },
              "messageFormat": {
                "type": "string",
                "enum": [
                  "json",
                  "xml",
                  "protobuf",
                  "avro",
                  "text",
                  "binary"
                ],
                "description": "Message format/serialization",
                "default": "json"
              },
              "partitions": {
                "type": "number",
                "minimum": 1,
                "description": "Number of partitions (for Kafka)"
              },
              "replicationFactor": {
                "type": "number",
                "minimum": 1,
                "description": "Replication factor (for Kafka)"
              },
              "consumerConfig": {
                "type": "object",
                "properties": {
                  "enabled": {
                    "type": "boolean",
                    "default": true,
                    "description": "Enable consumer"
                  },
                  "consumerGroup": {
                    "type": "string",
                    "description": "Consumer group ID"
                  },
                  "concurrency": {
                    "type": "number",
                    "minimum": 1,
                    "maximum": 100,
                    "default": 1,
                    "description": "Number of concurrent consumers"
                  },
                  "prefetchCount": {
                    "type": "number",
                    "minimum": 1,
                    "maximum": 1000,
                    "default": 10,
                    "description": "Prefetch count"
                  },
                  "ackMode": {
                    "type": "string",
                    "enum": [
                      "auto",
                      "manual",
                      "client"
                    ],
                    "description": "Message acknowledgment mode",
                    "default": "manual"
                  },
                  "autoCommit": {
                    "type": "boolean",
                    "default": false,
                    "description": "Auto-commit offsets"
                  },
                  "autoCommitIntervalMs": {
                    "type": "number",
                    "minimum": 100,
                    "default": 5000,
                    "description": "Auto-commit interval in ms"
                  },
                  "sessionTimeoutMs": {
                    "type": "number",
                    "minimum": 1000,
                    "default": 30000,
                    "description": "Session timeout in ms"
                  },
                  "rebalanceTimeoutMs": {
                    "type": "number",
                    "minimum": 1000,
                    "description": "Rebalance timeout in ms"
                  }
                },
                "additionalProperties": false,
                "description": "Consumer-specific configuration"
              },
              "producerConfig": {
                "type": "object",
                "properties": {
                  "enabled": {
                    "type": "boolean",
                    "default": true,
                    "description": "Enable producer"
                  },
                  "acks": {
                    "type": "string",
                    "enum": [
                      "0",
                      "1",
                      "all"
                    ],
                    "default": "all",
                    "description": "Acknowledgment level"
                  },
                  "compressionType": {
                    "type": "string",
                    "enum": [
                      "none",
                      "gzip",
                      "snappy",
                      "lz4",
                      "zstd"
                    ],
                    "default": "none",
                    "description": "Compression type"
                  },
                  "batchSize": {
                    "type": "number",
                    "minimum": 1,
                    "default": 16384,
                    "description": "Batch size in bytes"
                  },
                  "lingerMs": {
                    "type": "number",
                    "minimum": 0,
                    "default": 0,
                    "description": "Linger time in ms"
                  },
                  "maxInFlightRequests": {
                    "type": "number",
                    "minimum": 1,
                    "default": 5,
                    "description": "Max in-flight requests"
                  },
                  "idempotence": {
                    "type": "boolean",
                    "default": true,
                    "description": "Enable idempotent producer"
                  },
                  "transactional": {
                    "type": "boolean",
                    "default": false,
                    "description": "Enable transactional producer"
                  },
                  "transactionTimeoutMs": {
                    "type": "number",
                    "minimum": 1000,
                    "description": "Transaction timeout in ms"
                  }
                },
                "additionalProperties": false,
                "description": "Producer-specific configuration"
              },
              "dlqConfig": {
                "type": "object",
                "properties": {
                  "enabled": {
                    "type": "boolean",
                    "default": false,
                    "description": "Enable DLQ"
                  },
                  "queueName": {
                    "type": "string",
                    "description": "Dead letter queue/topic name"
                  },
                  "maxRetries": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 100,
                    "default": 3,
                    "description": "Max retries before DLQ"
                  },
                  "retryDelayMs": {
                    "type": "number",
                    "minimum": 0,
                    "default": 60000,
                    "description": "Retry delay in ms"
                  }
                },
                "required": [
                  "queueName"
                ],
                "additionalProperties": false,
                "description": "Dead letter queue configuration"
              },
              "routingKey": {
                "type": "string",
                "description": "Routing key pattern"
              },
              "messageFilter": {
                "type": "object",
                "properties": {
                  "headers": {
                    "type": "object",
                    "additionalProperties": {
                      "type": "string"
                    },
                    "description": "Filter by message headers"
                  },
                  "attributes": {
                    "type": "object",
                    "additionalProperties": {},
                    "description": "Filter by message attributes"
                  }
                },
                "additionalProperties": false,
                "description": "Message filter criteria"
              }
            },
            "required": [
              "name",
              "label",
              "topicName"
            ],
            "additionalProperties": false
          },
          "description": "Topics/queues to sync"
        },
        "deliveryGuarantee": {
          "type": "string",
          "enum": [
            "at_most_once",
            "at_least_once",
            "exactly_once"
          ],
          "description": "Message delivery guarantee",
          "default": "at_least_once"
        },
        "sslConfig": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": false,
              "description": "Enable SSL/TLS"
            },
            "rejectUnauthorized": {
              "type": "boolean",
              "default": true,
              "description": "Reject unauthorized certificates"
            },
            "ca": {
              "type": "string",
              "description": "CA certificate"
            },
            "cert": {
              "type": "string",
              "description": "Client certificate"
            },
            "key": {
              "type": "string",
              "description": "Client private key"
            }
          },
          "additionalProperties": false,
          "description": "SSL/TLS configuration"
        },
        "saslConfig": {
          "type": "object",
          "properties": {
            "mechanism": {
              "type": "string",
              "enum": [
                "plain",
                "scram-sha-256",
                "scram-sha-512",
                "aws"
              ],
              "description": "SASL mechanism"
            },
            "username": {
              "type": "string",
              "description": "SASL username"
            },
            "password": {
              "type": "string",
              "description": "SASL password"
            }
          },
          "required": [
            "mechanism"
          ],
          "additionalProperties": false,
          "description": "SASL authentication configuration"
        },
        "schemaRegistry": {
          "type": "object",
          "properties": {
            "url": {
              "type": "string",
              "format": "uri",
              "description": "Schema registry URL"
            },
            "auth": {
              "type": "object",
              "properties": {
                "username": {
                  "type": "string"
                },
                "password": {
                  "type": "string"
                }
              },
              "additionalProperties": false
            }
          },
          "required": [
            "url"
          ],
          "additionalProperties": false,
          "description": "Schema registry configuration"
        },
        "preserveOrder": {
          "type": "boolean",
          "default": true,
          "description": "Preserve message ordering"
        },
        "enableMetrics": {
          "type": "boolean",
          "default": true,
          "description": "Enable message queue metrics"
        },
        "enableTracing": {
          "type": "boolean",
          "default": false,
          "description": "Enable distributed tracing"
        }
      },
      "required": [
        "name",
        "label",
        "type",
        "authentication",
        "provider",
        "brokerConfig",
        "topics"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}