---
title: Worker
description: Worker protocol schemas
---

Worker System Protocol

Background task processing system with queues, priorities, and retry logic.

Provides a robust foundation for async task execution similar to:

- Sidekiq (Ruby)

- Celery (Python)

- Bull/BullMQ (Node.js)

- AWS SQS/Lambda

Features:

- Task queues with priorities

- Task scheduling and retry logic

- Batch processing

- Dead letter queues

- Task monitoring and logging

@example Basic task

```typescript

const task: Task = {

id: 'task-123',

type: 'send_email',

payload: { to: 'user@example.com', subject: 'Welcome' },

queue: 'notifications',

priority: 5

};

```

<Callout type="info">
**Source:** `packages/spec/src/system/worker.zod.ts`
</Callout>

## TypeScript Usage

```typescript
import { BatchProgress, BatchTask, QueueConfig, Task, TaskExecutionResult, TaskPriority, TaskRetryPolicy, TaskStatus, WorkerConfig, WorkerStats } from '@objectstack/spec/system';
import type { BatchProgress, BatchTask, QueueConfig, Task, TaskExecutionResult, TaskPriority, TaskRetryPolicy, TaskStatus, WorkerConfig, WorkerStats } from '@objectstack/spec/system';

// Validate data
const result = BatchProgress.parse(data);
```

---

## BatchProgress

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **batchId** | `string` | ✅ | Batch job identifier |
| **total** | `integer` | ✅ | Total number of items |
| **processed** | `integer` | optional | Items processed |
| **succeeded** | `integer` | optional | Items succeeded |
| **failed** | `integer` | optional | Items failed |
| **percentage** | `number` | ✅ | Progress percentage |
| **status** | `Enum<'pending' \| 'running' \| 'completed' \| 'failed' \| 'cancelled'>` | ✅ | Batch status |
| **startedAt** | `string` | optional | When batch started |
| **completedAt** | `string` | optional | When batch completed |


---

## BatchTask

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **id** | `string` | ✅ | Unique batch job identifier |
| **type** | `string` | ✅ | Task type (snake_case) |
| **items** | `any[]` | ✅ | Array of items to process |
| **batchSize** | `integer` | optional | Number of items per batch |
| **queue** | `string` | optional | Queue for batch tasks |
| **priority** | `Enum<'critical' \| 'high' \| 'normal' \| 'low' \| 'background'>` | optional | Batch task priority |
| **parallel** | `boolean` | optional | Process batches in parallel |
| **stopOnError** | `boolean` | optional | Stop batch if any item fails |


---

## QueueConfig

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **name** | `string` | ✅ | Queue name (snake_case) |
| **concurrency** | `integer` | optional | Max concurrent task executions |
| **rateLimit** | `Object` | optional | Rate limit configuration |
| **defaultRetryPolicy** | `Object` | optional | Default retry policy for tasks |
| **deadLetterQueue** | `string` | optional | Dead letter queue name |
| **priority** | `integer` | optional | Queue priority (lower = higher priority) |
| **autoScale** | `Object` | optional | Auto-scaling configuration |


---

## Task

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **id** | `string` | ✅ | Unique task identifier |
| **type** | `string` | ✅ | Task type (snake_case) |
| **payload** | `any` | optional | Task payload data |
| **queue** | `string` | optional | Queue name |
| **priority** | `Enum<'critical' \| 'high' \| 'normal' \| 'low' \| 'background'>` | optional | Task priority level |
| **retryPolicy** | `Object` | optional | Retry policy configuration |
| **timeoutMs** | `integer` | optional | Task timeout in milliseconds |
| **scheduledAt** | `string` | optional | ISO 8601 datetime to execute task |
| **attempts** | `integer` | optional | Number of execution attempts |
| **status** | `Enum<'pending' \| 'queued' \| 'processing' \| 'completed' \| 'failed' \| 'cancelled' \| 'timeout' \| 'dead'>` | optional | Current task status |
| **metadata** | `Object` | optional | Task metadata |


---

## TaskExecutionResult

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **taskId** | `string` | ✅ | Task identifier |
| **status** | `Enum<'pending' \| 'queued' \| 'processing' \| 'completed' \| 'failed' \| 'cancelled' \| 'timeout' \| 'dead'>` | ✅ | Execution status |
| **result** | `any` | optional | Execution result data |
| **error** | `Object` | optional | Error details if failed |
| **durationMs** | `integer` | optional | Execution duration in milliseconds |
| **startedAt** | `string` | ✅ | When execution started |
| **completedAt** | `string` | optional | When execution completed |
| **attempt** | `integer` | ✅ | Attempt number (1-indexed) |
| **willRetry** | `boolean` | ✅ | Whether task will be retried |


---

## TaskPriority

### Allowed Values

* `critical`
* `high`
* `normal`
* `low`
* `background`


---

## TaskRetryPolicy

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **maxRetries** | `integer` | optional | Maximum retry attempts |
| **backoffStrategy** | `Enum<'fixed' \| 'linear' \| 'exponential'>` | optional | Backoff strategy between retries |
| **initialDelayMs** | `integer` | optional | Initial retry delay in milliseconds |
| **maxDelayMs** | `integer` | optional | Maximum retry delay in milliseconds |
| **backoffMultiplier** | `number` | optional | Multiplier for exponential backoff |


---

## TaskStatus

### Allowed Values

* `pending`
* `queued`
* `processing`
* `completed`
* `failed`
* `cancelled`
* `timeout`
* `dead`


---

## WorkerConfig

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **name** | `string` | ✅ | Worker name |
| **queues** | `string[]` | ✅ | Queue names to process |
| **queueConfigs** | `Object[]` | optional | Queue configurations |
| **pollIntervalMs** | `integer` | optional | Queue polling interval in milliseconds |
| **visibilityTimeoutMs** | `integer` | optional | How long a task is invisible after being claimed |
| **defaultTimeoutMs** | `integer` | optional | Default task timeout in milliseconds |
| **shutdownTimeoutMs** | `integer` | optional | Graceful shutdown timeout in milliseconds |
| **handlers** | `Record<string, any>` | optional | Task type handlers |


---

## WorkerStats

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **workerName** | `string` | ✅ | Worker name |
| **totalProcessed** | `integer` | ✅ | Total tasks processed |
| **succeeded** | `integer` | ✅ | Successful tasks |
| **failed** | `integer` | ✅ | Failed tasks |
| **active** | `integer` | ✅ | Currently active tasks |
| **avgExecutionMs** | `number` | optional | Average execution time in milliseconds |
| **uptimeMs** | `integer` | ✅ | Worker uptime in milliseconds |
| **queues** | `Record<string, Object>` | optional | Per-queue statistics |


---

