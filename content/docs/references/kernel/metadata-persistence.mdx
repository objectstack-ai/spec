---
title: Metadata Persistence
description: Metadata Persistence protocol schemas
---

<Callout type="info">
**Source:** `packages/spec/src/kernel/metadata-persistence.zod.ts`
</Callout>

## TypeScript Usage

```typescript
import { MetadataCollectionInfo, MetadataExportOptions, MetadataFormat, MetadataImportOptions, MetadataLoadOptions, MetadataLoadResult, MetadataLoaderContract, MetadataManagerConfig, MetadataSaveOptions, MetadataSaveResult, MetadataStats, MetadataWatchEvent } from '@objectstack/spec/kernel';
import type { MetadataCollectionInfo, MetadataExportOptions, MetadataFormat, MetadataImportOptions, MetadataLoadOptions, MetadataLoadResult, MetadataLoaderContract, MetadataManagerConfig, MetadataSaveOptions, MetadataSaveResult, MetadataStats, MetadataWatchEvent } from '@objectstack/spec/kernel';

// Validate data
const result = MetadataCollectionInfo.parse(data);
```

---

## MetadataCollectionInfo

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **type** | `string` | ✅ | Collection type |
| **count** | `integer` | ✅ | Number of items |
| **formats** | `Enum<'json' \| 'yaml' \| 'typescript' \| 'javascript'>[]` | ✅ | Formats in collection |
| **totalSize** | `integer` | optional | Total size in bytes |
| **lastModified** | `string` | optional | Last modification date |
| **location** | `string` | optional | Collection location |


---

## MetadataExportOptions

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **output** | `string` | ✅ | Output file path |
| **format** | `Enum<'json' \| 'yaml' \| 'typescript' \| 'javascript'>` | optional | Export format |
| **filter** | `string` | optional | Filter items to export |
| **includeStats** | `boolean` | optional | Include metadata statistics |
| **compress** | `boolean` | optional | Compress output (gzip) |
| **prettify** | `boolean` | optional | Pretty print output |


---

## MetadataFormat

### Allowed Values

* `json`
* `yaml`
* `typescript`
* `javascript`


---

## MetadataImportOptions

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **conflictResolution** | `Enum<'skip' \| 'overwrite' \| 'merge' \| 'fail'>` | optional | How to handle existing items |
| **validate** | `boolean` | optional | Validate before import |
| **dryRun** | `boolean` | optional | Simulate import without saving |
| **continueOnError** | `boolean` | optional | Continue if validation fails |
| **transform** | `string` | optional | Transform items before import |


---

## MetadataLoadOptions

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **patterns** | `string[]` | optional | File glob patterns |
| **ifNoneMatch** | `string` | optional | ETag for conditional request |
| **ifModifiedSince** | `string` | optional | Only load if modified after this date |
| **validate** | `boolean` | optional | Validate against schema |
| **useCache** | `boolean` | optional | Enable caching |
| **filter** | `string` | optional | Filter predicate as string |
| **limit** | `integer` | optional | Maximum items to load |
| **recursive** | `boolean` | optional | Search subdirectories |


---

## MetadataLoadResult

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **data** | `any \| null` | optional | Loaded metadata |
| **fromCache** | `boolean` | optional | Loaded from cache |
| **notModified** | `boolean` | optional | Not modified since last request |
| **etag** | `string` | optional | Entity tag |
| **stats** | `Object` | optional | Metadata statistics |
| **loadTime** | `number` | optional | Load duration in ms |


---

## MetadataLoaderContract

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **name** | `string` | ✅ | Loader identifier |
| **protocol** | `string` | ✅ | Protocol identifier |
| **capabilities** | `Object` | ✅ | Loader capabilities |
| **supportedFormats** | `Enum<'json' \| 'yaml' \| 'typescript' \| 'javascript'>[]` | ✅ | Supported formats |
| **supportsWatch** | `boolean` | optional | Supports file watching |
| **supportsWrite** | `boolean` | optional | Supports write operations |
| **supportsCache** | `boolean` | optional | Supports caching |


---

## MetadataManagerConfig

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **rootDir** | `string` | optional | Root directory path |
| **formats** | `Enum<'json' \| 'yaml' \| 'typescript' \| 'javascript'>[]` | optional | Enabled formats |
| **cache** | `Object` | optional | Cache settings |
| **watch** | `boolean` | optional | Enable file watching |
| **watchOptions** | `Object` | optional | File watcher options |
| **validation** | `Object` | optional | Validation settings |
| **loaderOptions** | `Record<string, any>` | optional | Loader-specific configuration |


---

## MetadataSaveOptions

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **format** | `Enum<'json' \| 'yaml' \| 'typescript' \| 'javascript'>` | optional | Output format |
| **prettify** | `boolean` | optional | Format with indentation |
| **indent** | `integer` | optional | Indentation spaces |
| **sortKeys** | `boolean` | optional | Sort object keys |
| **includeDefaults** | `boolean` | optional | Include default values |
| **backup** | `boolean` | optional | Create backup file |
| **overwrite** | `boolean` | optional | Overwrite existing file |
| **atomic** | `boolean` | optional | Use atomic write operation |
| **path** | `string` | optional | Custom output path |


---

## MetadataSaveResult

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **success** | `boolean` | ✅ | Save successful |
| **path** | `string` | ✅ | Output path |
| **etag** | `string` | optional | Generated entity tag |
| **size** | `integer` | optional | File size |
| **saveTime** | `number` | optional | Save duration in ms |
| **backupPath** | `string` | optional | Backup file path |


---

## MetadataStats

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **size** | `integer` | ✅ | File size in bytes |
| **modifiedAt** | `string` | ✅ | Last modified date |
| **etag** | `string` | ✅ | Entity tag for cache validation |
| **format** | `Enum<'json' \| 'yaml' \| 'typescript' \| 'javascript'>` | ✅ | Serialization format |
| **path** | `string` | optional | File system path |
| **metadata** | `Record<string, any>` | optional | Provider-specific metadata |


---

## MetadataWatchEvent

### Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **type** | `Enum<'added' \| 'changed' \| 'deleted'>` | ✅ | Event type |
| **metadataType** | `string` | ✅ | Type of metadata |
| **name** | `string` | ✅ | Item identifier |
| **path** | `string` | ✅ | File path |
| **data** | `any` | optional | Item data |
| **timestamp** | `string` | ✅ | Event timestamp |


---

