---
title: QueryFilter
description: MongoDB-style query filter for data retrieval operations
---

# QueryFilter

QueryFilter provides a MongoDB-style, database-agnostic query DSL for filtering data. It supports implicit equality, explicit operators, logical combinations, and nested relation queries.

## Overview

QueryFilter is the top-level wrapper for filter conditions, typically used as the `where` clause in queries.

## Schema

```typescript
{
  where?: FilterCondition  // Optional filter criteria
}
```

## Properties

| Property | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| **where** | `FilterCondition` | optional | Filter criteria for the query |

## Filter Operators

### Equality Operators

| Operator | Description | Example |
| :--- | :--- | :--- |
| `$eq` | Equal to | `{ status: { $eq: "active" } }` |
| `$ne` | Not equal to | `{ status: { $ne: "deleted" } }` |

### Comparison Operators (Numeric/Date)

| Operator | Description | Example |
| :--- | :--- | :--- |
| `$gt` | Greater than | `{ age: { $gt: 18 } }` |
| `$gte` | Greater than or equal | `{ age: { $gte: 18 } }` |
| `$lt` | Less than | `{ score: { $lt: 100 } }` |
| `$lte` | Less than or equal | `{ age: { $lte: 65 } }` |

### Set & Range Operators

| Operator | Description | Example |
| :--- | :--- | :--- |
| `$in` | Value in array | `{ role: { $in: ["admin", "editor"] } }` |
| `$nin` | Value not in array | `{ status: { $nin: ["spam", "deleted"] } }` |
| `$between` | Between range (inclusive) | `{ age: { $between: [18, 65] } }` |

### String Operators

| Operator | Description | Example |
| :--- | :--- | :--- |
| `$contains` | Contains substring | `{ email: { $contains: "@example.com" } }` |
| `$startsWith` | Starts with prefix | `{ username: { $startsWith: "admin_" } }` |
| `$endsWith` | Ends with suffix | `{ filename: { $endsWith: ".pdf" } }` |

### Special Operators

| Operator | Description | Example |
| :--- | :--- | :--- |
| `$null` | Is null (true) or not null (false) | `{ deletedAt: { $null: true } }` |
| `$exist` | Field exists (true) or doesn't exist (false) | `{ metadata: { $exist: true } }` |

### Logical Operators

| Operator | Description | Example |
| :--- | :--- | :--- |
| `$and` | All conditions must be true | `{ $and: [{ status: "active" }, { age: { $gte: 18 } }] }` |
| `$or` | At least one condition must be true | `{ $or: [{ role: "admin" }, { role: "editor" }] }` |
| `$not` | Negates the condition | `{ $not: { status: "deleted" } }` |

## Usage Examples

### Basic Filtering

#### Implicit Equality
```typescript
const filter: QueryFilter = {
  where: {
    status: "active",      // Implicit equality
    verified: true
  }
};
```

#### Explicit Operators
```typescript
const filter: QueryFilter = {
  where: {
    age: { $gte: 18 },           // Comparison
    email: { $contains: "@company.com" },  // String match
    role: { $in: ["admin", "editor"] }     // Set membership
  }
};
```

### Logical Combinations

#### AND Conditions (Implicit)
```typescript
const filter: QueryFilter = {
  where: {
    status: "active",     // All fields at same level are AND'ed
    age: { $gte: 18 },
    verified: true
  }
};
```

#### OR Conditions
```typescript
const filter: QueryFilter = {
  where: {
    $or: [
      { role: "admin" },
      { permissions: { $contains: "write" } }
    ]
  }
};
```

#### Complex Nested Logic
```typescript
const filter: QueryFilter = {
  where: {
    status: "active",
    $or: [
      { priority: "high" },
      { 
        $and: [
          { dueDate: { $lt: new Date() } },
          { assignee: { $null: false } }
        ]
      }
    ]
  }
};
```

### Nested Relations

```typescript
const filter: QueryFilter = {
  where: {
    status: "active",
    department: {                  // Nested relation
      name: "Engineering",
      company: {                   // Deeply nested
        country: "USA"
      }
    }
  }
};
```

### Real-World Examples

#### User Search
```typescript
const userSearch: QueryFilter = {
  where: {
    $or: [
      { name: { $contains: "john" } },
      { email: { $contains: "john" } },
      { username: { $contains: "john" } }
    ],
    status: "active",
    role: { $in: ["user", "admin"] }
  }
};
```

#### E-commerce Order Filter
```typescript
const orderFilter: QueryFilter = {
  where: {
    status: { $in: ["pending", "processing", "shipped"] },
    totalAmount: { $gte: 100 },
    createdAt: {
      $between: [
        new Date("2024-01-01"),
        new Date("2024-12-31")
      ]
    },
    customer: {
      tier: "premium",
      country: { $in: ["US", "CA", "UK"] }
    }
  }
};
```

#### Content Management
```typescript
const contentFilter: QueryFilter = {
  where: {
    $and: [
      { published: true },
      { deletedAt: { $null: true } }
    ],
    $or: [
      { title: { $contains: "tutorial" } },
      { tags: { name: { $in: ["tutorial", "guide", "howto"] } } }
    ],
    author: {
      verified: true,
      role: { $in: ["editor", "admin"] }
    }
  }
};
```

## TypeScript Type Safety

```typescript
interface User {
  id: number;
  name: string;
  age: number;
  email: string;
  profile: {
    verified: boolean;
  };
}

// Type-safe filter
const filter: Filter<User> = {
  age: { $gte: 18 },
  email: { $contains: "@example.com" },
  profile: {
    verified: true
  }
};
```

## Design Principles

1. **Declarative**: Frontend describes "what data to get", not "how to query"
2. **Database Agnostic**: Syntax contains no database-specific directives
3. **Type Safe**: Structure can be statically inferred by TypeScript
4. **Convention over Configuration**: Implicit syntax for common queries

## See Also

- [FilterCondition](./FilterCondition.mdx) - Recursive filter structure details
- [NormalizedFilter](./NormalizedFilter.mdx) - Internal AST representation
- [Query](./types/Query.mdx) - Complete query specification
