---
title: REST API Protocol
description: 标准 Data API 与 Metadata API 接口规范
---

# REST API Protocol

ObjectStack 遵循 "Protocol First" 原则，提供了一套标准化的 RESTful API，用于前端与 ObjectOS 内核进行交互。

为了解决硬编码 URL 路径的问题，ObjectStack 引入了 **Discovery Protocol（发现协议）**。客户端应首先请求发现端点，获取当前环境的所有服务入口。

## 1. Discovery (入口发现)

客户端启动时（如 `App.init`），应首先请求此端点。

- **Endpoint**: `GET /.well-known/objectstack` 或 `GET /api/v1/discovery`
- **Response Type**: `DiscoveryResponse`

```json
{
  "name": "Acme CRM Production",
  "version": "1.0.0",
  "environment": "production",
  "routes": {
    "data": "/api/v1/data",
    "metadata": "/api/v1/meta",
    "auth": "/api/v1/auth",
    "actions": "/api/v1/actions",
    "storage": "/api/v1/storage",
    "graphql": "/api/v1/graphql"
  },
  "features": {
    "graphql": true,
    "search": true,
    "files": true
  },
  "locale": {
    "default": "zh-CN",
    "supported": ["en-US", "zh-CN"],
    "timezone": "Asia/Shanghai"
  }
}
```

## 2. Standard Data API (数据操作)

基于 `routes.data` 返回的基路径（默认为 `/api/v1/data`）。

### 查询对象记录 (Query)

- **Method**: `GET /:objectName`
- **Params**:
  - `select`: 字段列表（逗号分隔）
  - `filter`: 过滤条件（JSON string, try `filters` in QuerySchema）
  - `sort`: 排序（如 `created_at desc`）
  - `page`: 页码
  - `pageSize`: 每页数量

### 获取单条记录 (Retrieve)

- **Method**: `GET /:objectName/:recordId`

### 创建记录 (Create)

- **Method**: `POST /:objectName`
- **Body**: Record data object

### 更新记录 (Update)

- **Method**: `PATCH /:objectName/:recordId`
- **Body**: Changed fields

### 删除记录 (Delete)

- **Method**: `DELETE /:objectName/:recordId`

## 3. Standard Metadata API (元数据)

基于 `routes.metadata` 返回的基路径（默认为 `/api/v1/meta`）。

### 获取所有对象定义

- **Method**: `GET /objects`
- **Response**: List of `ObjectSchema` (summary)

### 获取特定对象定义

- **Method**: `GET /objects/:objectName`
- **Response**: Full `ObjectSchema` (incl. fields, validation)

### 获取应用导航菜单

- **Method**: `GET /menus`
- **Response**: `MenuItem[]`

## 4. Custom API Endpoints

开发者可以通过 `ApiEndpointSchema` 定义自定义的 API 接口，这些接口通常挂载在 `/api/v1/custom` 下或自定义路径。

详见 [Custom API Guide](/docs/specifications/server/custom-api).
