---
title: å¿«é€Ÿå¼€å§‹
description: 5 åˆ†é’Ÿå†…æ„å»ºä½ çš„ç¬¬ä¸€ä¸ª ObjectStack åº”ç”¨ç¨‹åº
---

ObjectStack æ˜¯åè®®ä¼˜å…ˆçš„å¹³å°ã€‚`@objectstack/spec` åŒ…æä¾›äº† Zod æ¨¡å¼å’Œä¸¥æ ¼çš„ TypeScript ç±»å‹æ¥æ„å»ºæœ‰æ•ˆçš„å…ƒæ•°æ®å®šä¹‰ã€‚

<Steps>

<Step>
## åˆå§‹åŒ–é¡¹ç›®

ä½ å¯ä»¥ä»å¤´å¼€å§‹æˆ–å°† ObjectStack æ·»åŠ åˆ°ç°æœ‰çš„ TypeScript é¡¹ç›®ä¸­ã€‚

```bash
mkdir my-app
cd my-app
npm init -y
npm install typescript zod @objectstack/spec
npx tsc --init
```
</Step>

<Step>
## å®šä¹‰ç¬¬ä¸€ä¸ªå¯¹è±¡

åˆ›å»ºæ–‡ä»¶ `src/domains/crm/contact.object.ts`ã€‚
è¿™å°±æ˜¯ **Zod ä¼˜å…ˆå®šä¹‰** çš„å¼ºå¤§ä¹‹å¤„ã€‚ä½ å¯ä»¥è·å¾—å¼€ç®±å³ç”¨çš„è‡ªåŠ¨å®Œæˆå’ŒéªŒè¯ã€‚

```typescript
import { ObjectSchema, Field } from '@objectstack/spec';

export const Contact = ObjectSchema.create({
  name: 'contact',
  label: 'è”ç³»äºº',
  pluralLabel: 'è”ç³»äºº',
  icon: 'user',
  description: 'ä¸è´¦æˆ·å…³è”çš„äººå‘˜',
  nameField: 'full_name',
  
  fields: {
    // åŸºæœ¬ä¿¡æ¯
    first_name: Field.text({ 
      label: 'å', 
      required: true,
      maxLength: 100,
    }),
    
    last_name: Field.text({ 
      label: 'å§“', 
      required: true,
      maxLength: 100,
    }),
    
    // å…¬å¼å­—æ®µ - è‡ªåŠ¨è®¡ç®—
    full_name: Field.formula({ 
      label: 'å…¨å',
      expression: 'CONCAT(first_name, " ", last_name)',
    }),
    
    // è”ç³»ä¿¡æ¯
    email: Field.email({ 
      label: 'ç”µå­é‚®ä»¶',
      unique: true,
    }),
    
    phone: Field.phone({ 
      label: 'ç”µè¯',
    }),
    
    // å¸¦é¢„å®šä¹‰é€‰é¡¹çš„é€‰æ‹©å­—æ®µ
    type: Field.select({
      label: 'è”ç³»äººç±»å‹',
      options: [
        { label: 'å®¢æˆ·', value: 'customer', default: true },
        { label: 'åˆä½œä¼™ä¼´', value: 'partner' },
        { label: 'ä¾›åº”å•†', value: 'vendor' },
      ],
    }),
    
    // ä¸è´¦æˆ·çš„å…³ç³»
    account: Field.masterDetail('account', {
      label: 'è´¦æˆ·',
      required: true,
      deleteBehavior: 'cascade',
    }),
  },
  
  enable: {
    apiEnabled: true,
    trackHistory: true,
  }
});
```
</Step>

<Step>
## æ·»åŠ è´¦æˆ·å¯¹è±¡

åˆ›å»º `src/domains/crm/account.object.ts` ä½œä¸ºçˆ¶å¯¹è±¡ï¼š

```typescript
import { ObjectSchema, Field } from '@objectstack/spec';

export const Account = ObjectSchema.create({
  name: 'account',
  label: 'è´¦æˆ·',
  pluralLabel: 'è´¦æˆ·',
  icon: 'building',
  nameField: 'name',
  
  fields: {
    // è‡ªåŠ¨ç¼–å·å­—æ®µ
    account_number: Field.autonumber({
      label: 'è´¦æˆ·ç¼–å·',
      format: 'ACC-{0000}',
    }),
    
    name: Field.text({ 
      label: 'è´¦æˆ·åç§°', 
      required: true,
      searchable: true,
      maxLength: 255,
    }),
    
    // è´§å¸å­—æ®µ
    annual_revenue: Field.currency({ 
      label: 'å¹´æ”¶å…¥',
      min: 0,
    }),
    
    // å¸¦è‡ªå®šä¹‰é¢œè‰²çš„é€‰æ‹©å­—æ®µï¼ˆç”¨äºçœ‹æ¿ï¼‰
    type: Field.select({
      label: 'è´¦æˆ·ç±»å‹',
      options: [
        { label: 'æ½œåœ¨å®¢æˆ·', value: 'prospect', color: '#FFA500', default: true },
        { label: 'å®¢æˆ·', value: 'customer', color: '#00AA00' },
        { label: 'åˆä½œä¼™ä¼´', value: 'partner', color: '#0000FF' },
      ],
    }),
  },
  
  enable: {
    apiEnabled: true,
    trackHistory: true,
  }
});
```
</Step>

<Step>
## åˆ›å»ºåº”ç”¨ç¨‹åºæ¸…å•

åˆ›å»º `objectstack.config.ts` å°†å¯¹è±¡æ‰“åŒ…åˆ°åº”ç”¨ä¸­ï¼š

```typescript
import { defineManifest } from '@objectstack/spec';
import { Account } from './src/domains/crm/account.object';
import { Contact } from './src/domains/crm/contact.object';

export default defineManifest({
  name: 'my_crm',
  label: 'æˆ‘çš„ CRM',
  version: '1.0.0',
  description: 'ç®€å•çš„ CRM åº”ç”¨ç¨‹åº',
  
  objects: [Account, Contact],
  
  navigation: {
    tabs: [
      {
        label: 'é”€å”®',
        items: [
          { type: 'object', object: 'account' },
          { type: 'object', object: 'contact' },
        ],
      },
    ],
  },
});
```
</Step>

<Step>
## éªŒè¯åè®®

åˆ›å»ºæ„å»ºè„šæœ¬ `src/build.ts` æ¥éªŒè¯ä½ çš„å®šä¹‰ï¼š

```typescript
import config from '../objectstack.config';

// å¦‚æœæ¨¡å¼æ— æ•ˆï¼Œè¿™å°†æŠ›å‡º ZodError
console.log(`âœ… åº”ç”¨ '${config.label}' æœ‰æ•ˆï¼`);
console.log(`ğŸ“¦ å¯¹è±¡: ${config.objects.map(o => o.name).join(', ')}`);

// å¯¼å‡ºä¸º JSON ä¾›è¿è¡Œæ—¶ä½¿ç”¨
import fs from 'fs';
fs.writeFileSync(
  'dist/manifest.json', 
  JSON.stringify(config, null, 2)
);
```

è¿è¡Œå®ƒï¼š

```bash
npx tsx src/build.ts
```
</Step>

<Step>
## æ¢ç´¢é«˜çº§åŠŸèƒ½

ç°åœ¨ä½ æœ‰äº†ä¸€ä¸ªå¯å·¥ä½œçš„åº”ç”¨ï¼Œæ¢ç´¢é«˜çº§åŠŸèƒ½ï¼š

### 1. æ·»åŠ éªŒè¯è§„åˆ™

```typescript
validations: [
  {
    name: 'unique_email',
    type: 'unique',
    fields: ['email'],
    message: 'ç”µå­é‚®ä»¶å·²å­˜åœ¨',
  },
  {
    name: 'positive_revenue',
    type: 'script',
    expression: 'annual_revenue >= 0',
    message: 'æ”¶å…¥å¿…é¡»ä¸ºæ­£æ•°',
  },
]
```

### 2. æ·»åŠ å·¥ä½œæµè§„åˆ™

```typescript
workflows: [
  {
    name: 'update_last_activity',
    trigger: 'on_update',
    actions: [
      {
        type: 'field_update',
        field: 'last_activity_date',
        value: 'TODAY()',
      },
    ],
  },
]
```

### 3. é…ç½®è§†å›¾

```typescript
views: {
  list: {
    type: 'grid',
    columns: ['account_number', 'name', 'type', 'annual_revenue'],
    filters: [
      { field: 'type', operator: '=', value: 'customer' }
    ],
  },
  kanban: {
    type: 'kanban',
    groupBy: 'type',
    columns: ['name', 'annual_revenue'],
  },
}
```
</Step>

<Step>
## ä¸‹ä¸€æ­¥

ç°åœ¨ä½ æœ‰äº†æœ‰æ•ˆçš„å…ƒæ•°æ®ï¼Œä½ å¯ä»¥ï¼š

1. **æ¢ç´¢ç¤ºä¾‹**ï¼šæŸ¥çœ‹ [CRM ç¤ºä¾‹](https://github.com/objectstack-ai/spec/tree/main/examples/crm) äº†è§£å®Œæ•´åŠŸèƒ½å®ç°
2. **å­¦ä¹ å­—æ®µç±»å‹**ï¼šå‚è§ [å­—æ®µç±»å‹æŒ‡å—](/docs/guides/field-types) äº†è§£æ‰€æœ‰ 35 ç§å­—æ®µç±»å‹
3. **æ„å»º UI**ï¼šä½¿ç”¨ ObjectStack è¿è¡Œæ—¶çš„å…ƒæ•°æ®æ¥ç”Ÿæˆç•Œé¢
4. **éƒ¨ç½²**ï¼šæ¨é€åˆ° ObjectStack å†…æ ¸ç”¨äºç”Ÿäº§ç¯å¢ƒ

**å…¶ä»–èµ„æºï¼š**
- [å¯¹è±¡æ¨¡å¼å‚è€ƒ](/docs/references/data/core/Object)
- [éªŒè¯è§„åˆ™](/docs/guides/validation-rules)
- [å·¥ä½œæµè‡ªåŠ¨åŒ–](/docs/guides/workflows)
</Step>

</Steps>
