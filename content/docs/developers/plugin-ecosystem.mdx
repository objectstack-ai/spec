---
title: Plugin Ecosystem Architecture
description: Building an interoperable plugin ecosystem for ObjectStack with vendor-agnostic protocols
---

# Plugin Ecosystem Architecture

## æ¦‚è¿° / Overview

ObjectStack é‡‡ç”¨å¾®å†…æ ¸æ¶æ„ï¼ˆMicroKernel Architectureï¼‰ï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½é€šè¿‡æ’ä»¶å®ç°ã€‚æœ¬æ–‡æ¡£å®šä¹‰äº†ä¸€ä¸ªå®Œæ•´çš„æ’ä»¶ç”Ÿæ€ç³»ç»Ÿè§„èŒƒï¼Œç¡®ä¿æ¥è‡ªä¸åŒå‚å•†çš„æ’ä»¶èƒ½å¤Ÿäº’ç›¸è°ƒç”¨ã€åä½œå’Œç»„åˆã€‚

ObjectStack uses a MicroKernel Architecture where all functionality is implemented through plugins. This document defines a comprehensive plugin ecosystem specification that ensures plugins from different vendors can call each other, collaborate, and compose together.

---

## ğŸ¯ è®¾è®¡ç›®æ ‡ / Design Goals

### 1. **åè®®ä¼˜å…ˆ / Protocol-First**
æ’ä»¶é€šè¿‡å£°æ˜å®ç°çš„åè®®ï¼ˆProtocolsï¼‰æ¥è¡¨è¾¾èƒ½åŠ›ï¼Œè€Œä¸æ˜¯ç¡¬ç¼–ç ä¾èµ–ã€‚ç±»ä¼¼äºï¼š
- Kubernetes CRDs (Custom Resource Definitions)
- OSGi Service Registry
- Eclipse Extension Points

Plugins declare capabilities through implementing **Protocols** rather than hard-coded dependencies, similar to:
- Kubernetes CRDs (Custom Resource Definitions)
- OSGi Service Registry
- Eclipse Extension Points

### 2. **è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ / Semantic Versioning**
æ‰€æœ‰åè®®å’Œæ’ä»¶å¿…é¡»ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆSemVerï¼‰ï¼Œç¡®ä¿å…¼å®¹æ€§ç®¡ç†ï¼š
- Major: ç ´åæ€§å˜æ›´
- Minor: å‘åå…¼å®¹çš„åŠŸèƒ½æ·»åŠ 
- Patch: å‘åå…¼å®¹çš„é”™è¯¯ä¿®å¤

All protocols and plugins must use Semantic Versioning (SemVer) for compatibility management:
- Major: Breaking changes
- Minor: Backwards-compatible feature additions
- Patch: Backwards-compatible bug fixes

### 3. **åå‘åŸŸåå‘½åè§„èŒƒ / Reverse Domain Naming**
æ‰€æœ‰æ’ä»¶å’Œåè®®ä½¿ç”¨åå‘åŸŸåè¡¨ç¤ºæ³•ç¡®ä¿å…¨å±€å”¯ä¸€æ€§ï¼š
```
{domain}.{category}.{name}
```

All plugins and protocols use reverse domain notation to ensure global uniqueness:
```
{domain}.{category}.{name}
```

**ç¤ºä¾‹ / Examples:**
- Plugin: `com.acme.crm.customer-management`
- Protocol: `com.objectstack.protocol.storage.v1`
- Interface: `com.acme.crm.interface.contact_service`

### 4. **æ¾è€¦åˆ / Loose Coupling**
æ’ä»¶é€šè¿‡æ¥å£ï¼ˆInterfacesï¼‰å’Œæ‰©å±•ç‚¹ï¼ˆExtension Pointsï¼‰é€šä¿¡ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¾èµ–å…·ä½“å®ç°ã€‚

Plugins communicate through **Interfaces** and **Extension Points**, not direct implementation dependencies.

---

## ğŸ—ï¸ æ ¸å¿ƒç»„ä»¶ / Core Components

### 1. åè®®å£°æ˜ / Protocol Declaration

**åè®®ï¼ˆProtocolï¼‰**å®šä¹‰äº†ä¸€ç»„æ ‡å‡†åŒ–çš„åŠŸèƒ½è§„èŒƒã€‚æ’ä»¶å£°æ˜å®ƒå®ç°äº†å“ªäº›åè®®ã€‚

A **Protocol** defines a standardized set of capabilities. Plugins declare which protocols they implement.

```typescript
import { PluginCapabilityManifest } from '@objectstack/spec/system';

const capabilities: PluginCapabilityManifest = {
  // å®ç°çš„åè®® / Implemented Protocols
  implements: [
    {
      protocol: {
        id: 'com.objectstack.protocol.storage.v1',
        label: 'Storage Protocol v1',
        version: { major: 1, minor: 0, patch: 0 },
      },
      conformance: 'full',  // full | partial | experimental | deprecated
      certified: true,      // æ˜¯å¦é€šè¿‡å®˜æ–¹è®¤è¯æµ‹è¯•
    },
  ],
};
```

#### ç¬¦åˆæ€§çº§åˆ« / Conformance Levels

| Level | Description (ä¸­æ–‡) | Description (English) |
|-------|-------------------|----------------------|
| `full` | å®Œæ•´å®ç°åè®®æ‰€æœ‰ç‰¹æ€§ | Complete implementation of all protocol features |
| `partial` | éƒ¨åˆ†å®ç°ï¼Œéœ€åˆ—å‡ºå·²å®ç°ç‰¹æ€§ | Subset implementation with specific features listed |
| `experimental` | å®éªŒæ€§å®ç°ï¼ŒAPI å¯èƒ½å˜åŒ– | Unstable/preview implementation |
| `deprecated` | å·²å¼ƒç”¨ä½†ä»æ”¯æŒ | Still supported but scheduled for removal |

### 2. æ¥å£æä¾› / Interface Provision

**æ¥å£ï¼ˆInterfaceï¼‰**å®šä¹‰æ’ä»¶å¯¹å¤–æä¾›çš„æœåŠ¡å¥‘çº¦ã€‚å…¶ä»–æ’ä»¶å¯ä»¥è°ƒç”¨è¿™äº›æ¥å£ã€‚

An **Interface** defines the service contract a plugin provides. Other plugins can call these interfaces.

```typescript
const capabilities: PluginCapabilityManifest = {
  // æä¾›çš„æ¥å£ / Provided Interfaces
  provides: [
    {
      id: 'com.acme.crm.interface.contact_service',
      name: 'ContactService',
      version: { major: 1, minor: 0, patch: 0 },
      stability: 'stable',  // stable | beta | alpha | experimental
      
      methods: [
        {
          name: 'getContact',
          description: 'Retrieve a contact by ID',
          parameters: [
            { name: 'id', type: 'string', required: true },
          ],
          returnType: 'Contact',
          async: true,
        },
        {
          name: 'createContact',
          parameters: [
            { name: 'data', type: 'ContactInput', required: true },
          ],
          returnType: 'Contact',
          async: true,
        },
      ],
      
      events: [
        {
          name: 'contactCreated',
          description: 'Fired when a new contact is created',
          payload: 'Contact',
        },
      ],
    },
  ],
};
```

### 3. ä¾èµ–å£°æ˜ / Dependency Declaration

æ’ä»¶å£°æ˜å¯¹å…¶ä»–æ’ä»¶çš„ä¾èµ–ï¼Œå¹¶æŒ‡å®šæ‰€éœ€çš„èƒ½åŠ›ã€‚

Plugins declare dependencies on other plugins and specify required capabilities.

```typescript
const capabilities: PluginCapabilityManifest = {
  // ä¾èµ–çš„æ’ä»¶ / Required Plugins
  requires: [
    {
      pluginId: 'com.objectstack.driver.postgres',
      version: '^1.0.0',  // æ”¯æŒ SemVer èŒƒå›´
      optional: false,
      requiredCapabilities: [
        'com.objectstack.protocol.storage.v1',
        'com.objectstack.protocol.transactions.v1',
      ],
    },
    {
      pluginId: 'com.acme.analytics',
      version: '>=2.0.0',
      optional: true,  // å¯é€‰ä¾èµ–
      reason: 'Enhanced analytics features',
    },
  ],
};
```

### 4. æ‰©å±•ç‚¹ / Extension Points

**æ‰©å±•ç‚¹ï¼ˆExtension Pointï¼‰**å…è®¸æ’ä»¶å£°æ˜å…¶ä»–æ’ä»¶å¯ä»¥æ‰©å±•çš„ä½ç½®ã€‚

**Extension Points** allow plugins to declare where other plugins can extend functionality.

```typescript
const capabilities: PluginCapabilityManifest = {
  // å®šä¹‰æ‰©å±•ç‚¹ / Define Extension Points
  extensionPoints: [
    {
      id: 'com.acme.crm.extension.contact_validator',
      name: 'Contact Validator',
      type: 'validator',  // action | hook | widget | provider | transformer | validator | decorator
      cardinality: 'multiple',  // single | multiple
      contract: {
        input: 'Contact',
        output: 'ValidationResult',
      },
    },
  ],
  
  // è´¡çŒ®æ‰©å±• / Contribute Extensions
  extensions: [
    {
      targetPluginId: 'com.acme.crm',
      extensionPointId: 'com.acme.crm.extension.contact_validator',
      implementation: './validators/email-validator.ts',
      priority: 50,  // ä¼˜å…ˆçº§ï¼ˆæ•°å­—è¶Šå°è¶Šé«˜ï¼‰
    },
  ],
};
```

#### æ‰©å±•ç‚¹ç±»å‹ / Extension Point Types

| Type | ç”¨é€” (Chinese) | Purpose (English) |
|------|---------------|------------------|
| `action` | å¯æ‰§è¡Œçš„æ“ä½œ | Executable actions |
| `hook` | ç”Ÿå‘½å‘¨æœŸé’©å­ | Lifecycle event hooks |
| `widget` | UI ç»„ä»¶ | UI components |
| `provider` | æ•°æ®/æœåŠ¡æä¾›è€… | Data/service providers |
| `transformer` | æ•°æ®è½¬æ¢å™¨ | Data transformers |
| `validator` | æ•°æ®éªŒè¯å™¨ | Data validators |
| `decorator` | åŠŸèƒ½è£…é¥°å™¨ | Functionality decorators |

---

## ğŸ“ å‘½åè§„èŒƒ / Naming Conventions

### 1. æ’ä»¶æ ‡è¯†ç¬¦ / Plugin Identifiers

**æ ¼å¼ / Format:**
```
{vendor-domain}.{category}.{plugin-name}
```

**è§„åˆ™ / Rules:**
- ä½¿ç”¨åå‘åŸŸåè¡¨ç¤ºæ³• / Use reverse domain notation
- å…¨å°å†™å­—æ¯ / All lowercase
- ä½¿ç”¨è¿å­—ç¬¦åˆ†éš”å•è¯ / Use hyphens for word separation
- é¿å…ä½¿ç”¨ä¸‹åˆ’çº¿å’Œé©¼å³°å‘½å / Avoid underscores and camelCase

**ç¤ºä¾‹ / Examples:**
```
âœ… com.objectstack.driver.postgres
âœ… com.acme.crm.customer-management
âœ… org.apache.kafka.connector
âŒ com.acme.CRM  (ä¸è¦ä½¿ç”¨å¤§å†™)
âŒ com.acme.crm_plugin  (ä¸è¦ä½¿ç”¨ä¸‹åˆ’çº¿)
```

### 2. åè®®æ ‡è¯†ç¬¦ / Protocol Identifiers

**æ ¼å¼ / Format:**
```
{vendor-domain}.protocol.{category}.{name}.v{major}
```

**ç¤ºä¾‹ / Examples:**
```
com.objectstack.protocol.storage.v1
com.objectstack.protocol.auth.oauth2.v2
com.acme.protocol.payment.stripe.v1
```

### 3. æ¥å£æ ‡è¯†ç¬¦ / Interface Identifiers

**æ ¼å¼ / Format:**
```
{plugin-id}.interface.{interface-name}
```

**ç¤ºä¾‹ / Examples:**
```
com.acme.crm.interface.contact_service
com.acme.analytics.interface.metrics_collector
```

### 4. æ‰©å±•ç‚¹æ ‡è¯†ç¬¦ / Extension Point Identifiers

**æ ¼å¼ / Format:**
```
{plugin-id}.extension.{extension-name}
```

**ç¤ºä¾‹ / Examples:**
```
com.acme.crm.extension.contact_validator
com.acme.app.extension.theme_provider
```

---

## ğŸ”„ æ’ä»¶å‘ç°ä¸æ³¨å†Œ / Plugin Discovery & Registry

### æ’ä»¶æ³¨å†Œè¡¨ / Plugin Registry

ObjectStack Hub æä¾›ä¸­å¿ƒåŒ–çš„æ’ä»¶æ³¨å†Œè¡¨ï¼Œæ”¯æŒï¼š
- æ’ä»¶å‘å¸ƒå’Œç‰ˆæœ¬ç®¡ç† / Plugin publishing and version management
- ä¾èµ–è§£æ / Dependency resolution
- èƒ½åŠ›æœç´¢ / Capability searching
- è´¨é‡è¯„åˆ† / Quality scoring
- å®‰å…¨æ‰«æ / Security scanning

The ObjectStack Hub provides a centralized plugin registry that supports:

```typescript
import { PluginRegistryEntry } from '@objectstack/spec/hub';

const registryEntry: PluginRegistryEntry = {
  id: 'com.acme.crm.customer-management',
  version: '1.2.3',
  name: 'Customer Management Plugin',
  description: 'Comprehensive customer relationship management',
  
  category: 'data',
  tags: ['crm', 'customer', 'sales'],
  
  vendor: {
    id: 'com.acme',
    name: 'ACME Corporation',
    verified: true,
    trustLevel: 'verified',
  },
  
  capabilities: { /* ... */ },
  
  quality: {
    testCoverage: 85,
    documentationScore: 90,
    securityScan: {
      passed: true,
      vulnerabilities: { critical: 0, high: 0, medium: 0, low: 0 },
    },
  },
  
  statistics: {
    downloads: 15000,
    ratings: { average: 4.5, count: 120 },
  },
};
```

### æœç´¢å’Œè¿‡æ»¤ / Search & Filtering

```typescript
import { PluginSearchFilters } from '@objectstack/spec/hub';

const filters: PluginSearchFilters = {
  query: 'CRM',
  category: ['data', 'integration'],
  implementsProtocols: ['com.objectstack.protocol.storage.v1'],
  trustLevel: ['official', 'verified'],
  minRating: 4.0,
  sortBy: 'downloads',
};
```

---

## ğŸ” æ’ä»¶å®‰å…¨ä¸è´¨é‡ / Plugin Security & Quality

### 1. å‚å•†éªŒè¯ / Vendor Verification

æ’ä»¶æ³¨å†Œè¡¨æ”¯æŒå¤šçº§ä¿¡ä»»çº§åˆ«ï¼š

The plugin registry supports multiple trust levels:

| Trust Level | è¯´æ˜ (Chinese) | Description (English) |
|-------------|---------------|----------------------|
| `official` | ObjectStack å®˜æ–¹æ’ä»¶ | Official ObjectStack plugins |
| `verified` | ç»è¿‡éªŒè¯çš„å‚å•† | Verified vendors |
| `community` | ç¤¾åŒºè´¡çŒ® | Community contributions |
| `unverified` | æœªéªŒè¯çš„å‚å•† | Unverified vendors |

### 2. è´¨é‡æŒ‡æ ‡ / Quality Metrics

```typescript
quality: {
  testCoverage: 85,           // æµ‹è¯•è¦†ç›–ç‡
  documentationScore: 90,     // æ–‡æ¡£è¯„åˆ†
  codeQuality: 88,            // ä»£ç è´¨é‡
  
  securityScan: {
    lastScanDate: '2024-01-15T00:00:00Z',
    vulnerabilities: {
      critical: 0,
      high: 0,
      medium: 1,
      low: 3,
    },
    passed: true,
  },
  
  conformanceTests: [
    {
      protocolId: 'com.objectstack.protocol.storage.v1',
      passed: true,
      totalTests: 150,
      passedTests: 150,
    },
  ],
}
```

### 3. æƒé™å£°æ˜ / Permission Declaration

æ’ä»¶å¿…é¡»åœ¨ manifest ä¸­å£°æ˜æ‰€éœ€æƒé™ï¼š

Plugins must declare required permissions in their manifest:

```typescript
// objectstack.config.ts
export default {
  id: 'com.acme.analytics',
  permissions: [
    'system.user.read',         // è¯»å–ç”¨æˆ·æ•°æ®
    'system.data.write',        // å†™å…¥æ•°æ®
    'network.http.request',     // å‘èµ· HTTP è¯·æ±‚
    'storage.local.write',      // æœ¬åœ°å­˜å‚¨å†™å…¥
  ],
};
```

---

## ğŸŒ è·¨æ’ä»¶é€šä¿¡æ¨¡å¼ / Inter-Plugin Communication Patterns

### æ¨¡å¼ 1: æ¥å£è°ƒç”¨ / Pattern 1: Interface Invocation

æ’ä»¶ A è°ƒç”¨æ’ä»¶ B æä¾›çš„æœåŠ¡ã€‚

Plugin A invokes services provided by Plugin B.

```typescript
// Plugin B: æä¾›æ¥å£ / Provides Interface
export class ContactServicePlugin implements Plugin {
  name = 'com.acme.crm';
  
  async init(ctx: PluginContext) {
    ctx.registerService('contact-service', {
      async getContact(id: string): Promise<Contact> {
        // Implementation
      },
    });
  }
}

// Plugin A: ä½¿ç”¨æ¥å£ / Uses Interface
export class ReportingPlugin implements Plugin {
  name = 'com.acme.reporting';
  dependencies = ['com.acme.crm'];
  
  async start(ctx: PluginContext) {
    const contactService = ctx.getService('contact-service');
    const contact = await contactService.getContact('123');
  }
}
```

### æ¨¡å¼ 2: äº‹ä»¶æ€»çº¿ / Pattern 2: Event Bus

æ’ä»¶é€šè¿‡å‘å¸ƒ/è®¢é˜…æ¨¡å¼é€šä¿¡ã€‚

Plugins communicate through publish/subscribe pattern.

```typescript
// Plugin A: å‘å¸ƒäº‹ä»¶ / Publishes Events
await ctx.trigger('crm:contact:created', {
  contactId: '123',
  data: contact,
});

// Plugin B: è®¢é˜…äº‹ä»¶ / Subscribes to Events
ctx.hook('crm:contact:created', async (event) => {
  console.log('New contact:', event.data);
});
```

### æ¨¡å¼ 3: æ‰©å±•ç‚¹è´¡çŒ® / Pattern 3: Extension Contribution

æ’ä»¶ A ä¸ºæ’ä»¶ B æä¾›æ‰©å±•ã€‚

Plugin A contributes extensions to Plugin B.

```typescript
// Plugin B: å®šä¹‰æ‰©å±•ç‚¹ / Defines Extension Point
capabilities: {
  extensionPoints: [{
    id: 'com.acme.crm.extension.contact_validator',
    type: 'validator',
    contract: {
      input: 'Contact',
      output: 'ValidationResult',
    },
  }],
}

// Plugin A: è´¡çŒ®æ‰©å±• / Contributes Extension
capabilities: {
  extensions: [{
    targetPluginId: 'com.acme.crm',
    extensionPointId: 'com.acme.crm.extension.contact_validator',
    implementation: './validators/email-validator.ts',
  }],
}
```

---

## ğŸ“¦ å®Œæ•´ç¤ºä¾‹ / Complete Example

### åœºæ™¯ï¼šæ„å»º CRM ç”Ÿæ€ / Scenario: Building a CRM Ecosystem

#### 1. æ ¸å¿ƒ CRM æ’ä»¶ / Core CRM Plugin

```typescript
// objectstack.config.ts
import { ObjectStackManifest } from '@objectstack/spec/system';

const manifest: ObjectStackManifest = {
  id: 'com.acme.crm',
  version: '1.0.0',
  type: 'plugin',
  name: 'ACME CRM Core',
  
  capabilities: {
    // å®ç°å­˜å‚¨åè®®
    implements: [
      {
        protocol: {
          id: 'com.objectstack.protocol.storage.v1',
          label: 'Storage Protocol',
          version: { major: 1, minor: 0, patch: 0 },
        },
        conformance: 'full',
      },
    ],
    
    // æä¾›å®¢æˆ·æœåŠ¡æ¥å£
    provides: [
      {
        id: 'com.acme.crm.interface.customer_service',
        name: 'CustomerService',
        version: { major: 1, minor: 0, patch: 0 },
        methods: [
          {
            name: 'getCustomer',
            parameters: [{ name: 'id', type: 'string' }],
            returnType: 'Customer',
            async: true,
          },
        ],
      },
    ],
    
    // å®šä¹‰æ‰©å±•ç‚¹
    extensionPoints: [
      {
        id: 'com.acme.crm.extension.customer_enrichment',
        name: 'Customer Data Enrichment',
        type: 'transformer',
        cardinality: 'multiple',
      },
    ],
  },
  
  objects: ['./src/objects/*.object.ts'],
};

export default manifest;
```

#### 2. é‚®ä»¶é›†æˆæ’ä»¶ / Email Integration Plugin

```typescript
// objectstack.config.ts
const manifest: ObjectStackManifest = {
  id: 'com.acme.crm.email-integration',
  version: '1.0.0',
  type: 'plugin',
  name: 'Email Integration for CRM',
  
  capabilities: {
    // ä¾èµ– CRM æ ¸å¿ƒ
    requires: [
      {
        pluginId: 'com.acme.crm',
        version: '^1.0.0',
        requiredCapabilities: [
          'com.acme.crm.interface.customer_service',
        ],
      },
    ],
    
    // å®ç°é‚®ä»¶åè®®
    implements: [
      {
        protocol: {
          id: 'com.objectstack.protocol.email.v1',
          label: 'Email Protocol',
          version: { major: 1, minor: 0, patch: 0 },
        },
        conformance: 'full',
      },
    ],
    
    // è´¡çŒ®æ•°æ®ä¸°å¯ŒåŒ–æ‰©å±•
    extensions: [
      {
        targetPluginId: 'com.acme.crm',
        extensionPointId: 'com.acme.crm.extension.customer_enrichment',
        implementation: './enrichment/email-enricher.ts',
        priority: 100,
      },
    ],
  },
};

export default manifest;
```

#### 3. åˆ†ææ’ä»¶ / Analytics Plugin

```typescript
const manifest: ObjectStackManifest = {
  id: 'com.acme.crm.analytics',
  version: '2.0.0',
  type: 'plugin',
  name: 'CRM Analytics',
  
  capabilities: {
    requires: [
      {
        pluginId: 'com.acme.crm',
        version: '^1.0.0',
      },
    ],
    
    provides: [
      {
        id: 'com.acme.crm.interface.analytics_service',
        name: 'AnalyticsService',
        version: { major: 2, minor: 0, patch: 0 },
        methods: [
          {
            name: 'getMetrics',
            parameters: [
              { name: 'query', type: 'MetricsQuery' },
            ],
            returnType: 'MetricsResult',
            async: true,
          },
        ],
        events: [
          {
            name: 'metricsUpdated',
            payload: 'MetricsSnapshot',
          },
        ],
      },
    ],
  },
};

export default manifest;
```

---

## ğŸš€ æœ€ä½³å®è·µ / Best Practices

### 1. åè®®è®¾è®¡ / Protocol Design

#### âœ… æ¨è / Recommended
- ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶
- åè®®åº”è¯¥ç¨³å®šä¸”å‘åå…¼å®¹
- æä¾›æ¸…æ™°çš„åè®®æ–‡æ¡£å’Œç¤ºä¾‹
- å®šä¹‰æ˜ç¡®çš„æµ‹è¯•è§„èŒƒ

- Use semantic versioning
- Protocols should be stable and backwards compatible
- Provide clear protocol documentation and examples
- Define explicit test specifications

#### âŒ é¿å… / Avoid
- åœ¨åè®®ä¸­æš´éœ²å®ç°ç»†èŠ‚
- é¢‘ç¹çš„ç ´åæ€§å˜æ›´
- æ²¡æœ‰æ–‡æ¡£çš„åè®®

- Exposing implementation details in protocols
- Frequent breaking changes
- Undocumented protocols

### 2. æ’ä»¶è®¾è®¡ / Plugin Design

#### âœ… æ¨è / Recommended
```typescript
// æ˜ç¡®å£°æ˜ä¾èµ– / Explicitly declare dependencies
requires: [{
  pluginId: 'com.objectstack.driver.postgres',
  version: '^1.0.0',
  requiredCapabilities: ['com.objectstack.protocol.storage.v1'],
}]

// ä½¿ç”¨æ‰©å±•ç‚¹è€Œéç¡¬ç¼–ç  / Use extension points instead of hard-coding
extensionPoints: [{
  id: 'com.acme.app.extension.authentication',
  type: 'provider',
  cardinality: 'single',
}]

// æä¾›æ¸…æ™°çš„æ¥å£ / Provide clear interfaces
provides: [{
  id: 'com.acme.interface.user_service',
  methods: [/* well-documented methods */],
  stability: 'stable',
}]
```

#### âŒ é¿å… / Avoid
```typescript
// âŒ ä¸è¦ç›´æ¥ import å…¶ä»–æ’ä»¶
import { UserService } from '@acme/other-plugin';

// âŒ ä¸è¦ä½¿ç”¨å…¨å±€çŠ¶æ€
global.myPluginData = {};

// âŒ ä¸è¦ç¡¬ç¼–ç æ’ä»¶æ ‡è¯†
const otherId = 'other-plugin';  // åº”è¯¥ä½¿ç”¨ manifest ä¸­çš„ id
```

### 3. ç‰ˆæœ¬ç®¡ç† / Version Management

```typescript
// âœ… ä½¿ç”¨ SemVer èŒƒå›´
version: '^1.0.0'    // >= 1.0.0 < 2.0.0
version: '~1.2.3'    // >= 1.2.3 < 1.3.0
version: '>=2.0.0 <3.0.0'

// âœ… æ ‡è®°å¼ƒç”¨
deprecated: true,
deprecationMessage: 'Use com.acme.crm.v2 instead',
replacedBy: 'com.acme.crm.v2',
```

### 4. æµ‹è¯•ä¸éªŒè¯ / Testing & Validation

```typescript
// åè®®ä¸€è‡´æ€§æµ‹è¯• / Protocol Conformance Tests
describe('Storage Protocol Conformance', () => {
  it('should implement all required methods', async () => {
    const driver = new MyDriver();
    expect(driver.query).toBeDefined();
    expect(driver.insert).toBeDefined();
    // ...
  });
});

// é›†æˆæµ‹è¯• / Integration Tests
describe('Plugin Integration', () => {
  it('should work with CRM plugin', async () => {
    const kernel = new ObjectKernel();
    kernel.use(new CRMPlugin());
    kernel.use(new MyPlugin());
    await kernel.bootstrap();
    // Test inter-plugin communication
  });
});
```

---

## ğŸ“š å‚è€ƒèµ„æ–™ / References

### ç›¸å…³æ–‡æ¡£ / Related Documentation
- [MicroKernel Architecture](/docs/developers/micro-kernel) - æ ¸å¿ƒæ¶æ„æ¦‚è§ˆ
- [Writing Plugins](/docs/developers/writing-plugins) - æ’ä»¶å¼€å‘æŒ‡å—
- [Manifest Schema](/docs/references/system/manifest) - æ¸…å•æ–‡ä»¶è§„èŒƒ
- [Plugin Capability Protocol](/docs/references/system/plugin-capability) - èƒ½åŠ›å£°æ˜åè®®
- [Plugin Registry](/docs/references/hub/plugin-registry) - æ’ä»¶æ³¨å†Œè¡¨

### å·¥ä¸šæ ‡å‡†å‚è€ƒ / Industry Standard References
- [OSGi Service Platform](https://www.osgi.org/) - Java æ¨¡å—åŒ–ç³»ç»Ÿ
- [Eclipse Extension Points](https://wiki.eclipse.org/FAQ_What_are_extensions_and_extension_points) - Eclipse æ‰©å±•æœºåˆ¶
- [Kubernetes CRDs](https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/) - K8s è‡ªå®šä¹‰èµ„æº
- [VS Code Extension API](https://code.visualstudio.com/api) - VS Code æ‰©å±• API

---

## ğŸ“ æ€»ç»“ / Summary

ObjectStack æ’ä»¶ç”Ÿæ€ç³»ç»Ÿé€šè¿‡ä»¥ä¸‹æœºåˆ¶ç¡®ä¿å‚å•†é—´çš„äº’æ“ä½œæ€§ï¼š

The ObjectStack plugin ecosystem ensures vendor interoperability through:

1. **åè®®ä¼˜å…ˆè®¾è®¡** / **Protocol-First Design** - æ’ä»¶é€šè¿‡åè®®è€Œéå®ç°é€šä¿¡
2. **åå‘åŸŸåå‘½å** / **Reverse Domain Naming** - ç¡®ä¿å…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦
3. **èƒ½åŠ›å£°æ˜** / **Capability Declaration** - æ˜ç¡®çš„æ¥å£å’Œä¾èµ–å£°æ˜
4. **æ‰©å±•ç‚¹æœºåˆ¶** / **Extension Points** - æ ‡å‡†åŒ–çš„æ‰©å±•æ–¹å¼
5. **ç‰ˆæœ¬ç®¡ç†** / **Version Management** - è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶
6. **è´¨é‡ä¿è¯** / **Quality Assurance** - æµ‹è¯•ã€è®¤è¯å’Œè¯„åˆ†ç³»ç»Ÿ
7. **ä¸­å¿ƒåŒ–æ³¨å†Œè¡¨** / **Centralized Registry** - æ’ä»¶å‘ç°å’Œä¾èµ–è§£æ

é€šè¿‡éµå¾ªè¿™äº›è§„èŒƒï¼Œä¸åŒå‚å•†çš„æ’ä»¶å¯ä»¥ï¼š
- ğŸ” äº’ç›¸å‘ç°å’Œä¾èµ–
- ğŸ¤ å®‰å…¨åœ°ç›¸äº’è°ƒç”¨
- ğŸ”Œ çµæ´»åœ°ç»„åˆå’Œæ‰©å±•
- ğŸ“ˆ æŒç»­æ¼”è¿›è€Œä¸ç ´åå…¼å®¹æ€§

By following these specifications, plugins from different vendors can:
- ğŸ” Discover and depend on each other
- ğŸ¤ Safely invoke each other's services
- ğŸ”Œ Flexibly compose and extend
- ğŸ“ˆ Continuously evolve without breaking compatibility
